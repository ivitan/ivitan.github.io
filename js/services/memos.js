utils.jq(()=>{$(function(){for(var e=document.getElementsByClassName("ds-memos"),t=0;t<e.length;t++){const c=e[t],i=c.getAttribute("api");if(null!=i){const o=c.getAttribute("avatar")||def.avatar,g=c.getAttribute("limit"),u=i.replace(/https:\/\/(.*?)\/(.*)/i,"$1");utils.request(c,i,function(e){var l=[];const t=c.getAttribute("user");t&&0<t.length&&(l=t.split(","));var d=[];const i=c.getAttribute("hide");i&&0<i.length&&(d=i.split(",")),e.forEach((t,i)=>{if(!(g&&i>=g)&&(!(t.user&&t.user.login&&0<l.length)||l.includes(t.user.login))){let e=new Date(1e3*t.createdTs);var s,a='<div class="timenode" index="'+i+'">',n=(a+='<div class="header">',l.length||d.includes("user")||(a+='<div class="user-info">',0<o.length&&(a+=`<img src="${o}">`),a=a+("<span>"+t.creatorName)+"</span></div>"),a=(a=(a+="<span>"+e.toLocaleString()+"</span>")+"</div>"+'<div class="body">')+marked.parse(t.content||""),[]);for(s of t.resourceList)s.type?.includes("image/")&&n.push(s);if(0<n.length){a+='<div class="tag-plugin image">';for(var r of n)0<r.externalLink?.length?a+=`<div class="image-bg"><img src="${r.externalLink}" data-fancybox="memos"></div>`:a+=`<div class="image-bg"><img src="https://${u}/o/r/${r.id}" data-fancybox="memos"></div>`;a+="</div>"}a=a+"</div>"+"</div>",$(c).append(a)}})})}}})});