<!DOCTYPE html><html><head><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-144334903-1","auto"),ga("send","pageview")</script><script async src="https://www.google-analytics.com/analytics.js"></script><meta charset="utf-8"><meta name="sogou_site_verification" content="ivC590WMZh"><link rel="canonical" href="https://vitan.me/posts/SQLstyle.html"><title>SQL 规范 - Vitan&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#3F51B5"><meta name="keywords" content="SQL"><meta name="description" content="SQL规范，注意事项。"><meta property="og:type" content="article"><meta property="og:title" content="SQL 规范"><meta property="og:url" content="https://vitan.me/posts/SQLstyle.html"><meta property="og:site_name" content="Vitan&#39;s Blog"><meta property="og:description" content="SQL规范，注意事项。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2018-06-09T02:15:14.000Z"><meta property="article:modified_time" content="2020-04-08T12:38:30.000Z"><meta property="article:author" content="Vitan"><meta property="article:tag" content="SQL"><meta name="twitter:card" content="summary"><link rel="alternate" type="application/atom+xml" title="Vitan&#39;s Blog" href="/xml/atom.xml"><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/css/style.css?v=1.7.2"><script>window.lazyScripts=[]</script><meta name="generator" content="Hexo 4.2.0"></head><body><div id="loading" class="active"></div><aside id="menu" class="hide"><div class="inner flex-row-vertical"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off"><i class="icon icon-lg icon-close"></i></a><div class="brand-wrap" style="background-image:url(/img/brand.png)"><div class="brand"><a href="/" class="avatar waves-effect waves-circle waves-light"><img src="/img/ivitan.png"></a><hgroup class="introduce"><h5 class="nickname">Vitan</h5><a href="mailto:admin@vitan.me" title="admin@vitan.me" class="mail">admin@vitan.me</a></hgroup></div></div><div class="scroll-wrap flex-col"><ul class="nav"><li class="waves-block waves-effect"><a href="/"><i class="icon icon-lg icon-home"></i> 主页</a></li><li class="waves-block waves-effect"><a href="/tags"><i class="icon icon-lg icon-tags"></i> 标签</a></li><li class="waves-block waves-effect"><a href="/categories"><i class="icon icon-lg icon-th-list"></i> 分类</a></li><li class="waves-block waves-effect"><a href="/archives"><i class="icon icon-lg icon-archives"></i> 归档</a></li><li class="waves-block waves-effect"><a href="/about"><i class="icon icon-lg icon-info-circle"></i> 关于</a></li><li class="waves-block waves-effect"><a href="https://github.com/ivitan" target="_blank"><i class="icon icon-lg icon-github"></i> Github</a></li></ul></div></div></aside><main id="main"><header class="top-header" id="header"><div class="flex-row"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle"><i class="icon icon-lg icon-navicon"></i></a><div class="flex-col header-title ellipsis">SQL 规范</div><div class="search-wrap" id="search-wrap"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back"><i class="icon icon-lg icon-chevron-left"></i> </a><input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字"> <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search"><i class="icon icon-lg icon-search"></i></a></div><a href="https://github.com/ivitan" class="header-icon waves-effect waves-circle waves-light" target="_blank" title="Github"><i class="icon icon-lg icon-github"></i></a></div></header><header class="content-header post-header"><div class="container fade-scale"><h1 class="title">SQL 规范</h1><h5 class="subtitle"><time datetime="2018-06-09T02:15:14.000Z" itemprop="datePublished" class="page-time">2018-06-09</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/">Database</a></li></ul></h5></div></header><div class="container body-wrap"><aside class="post-widget"><nav class="post-toc-wrap post-toc-shrink" id="post-toc"><h4>TOC</h4><ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#MySQL-常用的存储引擎"><span class="post-toc-number">1.</span> <span class="post-toc-text">MySQL 常用的存储引擎</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#表及字段的命名规则"><span class="post-toc-number">2.</span> <span class="post-toc-text">表及字段的命名规则</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#字段类型的选择原则"><span class="post-toc-number">3.</span> <span class="post-toc-text">字段类型的选择原则</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#char-varchar-如何选择"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">char varchar 如何选择</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#decimal与float-如何选择"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">decimal与float 如何选择</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#时间类型如何存储"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">时间类型如何存储</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#如何选择主键"><span class="post-toc-number">4.</span> <span class="post-toc-text">如何选择主键</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#关于预留字段"><span class="post-toc-number">5.</span> <span class="post-toc-text">关于预留字段</span></a></li></ol></nav></aside><article id="post-SQLstyle" class="post-article article-type-post fade" itemprop="blogPost"><div class="post-card"><h1 class="post-card-title">SQL 规范</h1><div class="post-meta"><time class="post-time" title="2018-06-09 10:15:14" datetime="2018-06-09T02:15:14.000Z" itemprop="datePublished"><i class="icon icon-calendar"></i> 2018-06-09</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Database/">Database</a></li></ul><span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none"><i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span></span></div><div class="post-content" id="post-content" itemprop="postContent"><p>SQL规范，注意事项。</p><a id="more"></a><h1 id="MySQL-常用的存储引擎"><a href="#MySQL-常用的存储引擎" class="headerlink" title="MySQL 常用的存储引擎"></a>MySQL 常用的存储引擎</h1><p>数据引擎表<br>|存储引擎|事务|锁粒度|主要应用|忌用|<br>|:—|:—|:—|:—|:—|<br>|MYISAM|不支持|支持并发插入的表级锁|SELECT,INSERT|读写操作频繁|<br>|MRG_MYISAM|不支持|支持并发插入的表级锁|分段归档,数据仓库|数全局查找过多的场景|<br>|Innodb|支持|支持MVCC的行级锁|事务处理|无|<br>|Archive|不支持|行级锁|日志记录只支持insert,select|需要随机读取,更新,删除|<br>|Ndb cluster|支持|行级锁|高可用性|大部份应用|</p><h1 id="表及字段的命名规则"><a href="#表及字段的命名规则" class="headerlink" title="表及字段的命名规则"></a>表及字段的命名规则</h1><p>规则</p><ul><li>可读性原则<ul><li>使用大写和小写来格式化的库对象名字以获得良好的可读性。<ul><li>例如:使用CustAddress而不是Custaddress来提高可读性。(这里要注意有些DBMS系统对表名的大小写是敏感的)</li></ul></li></ul></li><li>表意性原则<ul><li>对象的名字应该能够描述它所标识的对象。<ul><li>例如,对于表,表的名称应该能够体现表中存储的数据内容;对于存储过程,存储过程名称应该能够体现存储过程的功能。</li></ul></li></ul></li><li>长名原则<ul><li>尽可能少使用或者不使用缩写,<ul><li>适用于数据库(DATABASE)名之外的任一对象。<h1 id="字段类型的选择原则"><a href="#字段类型的选择原则" class="headerlink" title="字段类型的选择原则"></a>字段类型的选择原则</h1>原因<br>列的数据类型一方面影响数据存储空间的开销,另一方面也会影响数据查询性能。当一个列可以选择多种数据类型时,应该优先考虑数字类型,其次是日期或二进制类型,最后是字符类型。对于相同级别的数据类型,应该优先选择占用空间小的数据类型。</li></ul></li></ul></li></ul><table><thead><tr><th align="center">列类型</th><th align="center">存储空间</th></tr></thead><tbody><tr><td align="center">TINYINT</td><td align="center">1字节</td></tr><tr><td align="center">SMALLINT</td><td align="center">2个字节</td></tr><tr><td align="center">MEDIUMINT</td><td align="center">3个字节</td></tr><tr><td align="center">INT</td><td align="center">4个字节</td></tr><tr><td align="center">BIGINT</td><td align="center">8个字节</td></tr><tr><td align="center">DATE</td><td align="center">13个字节</td></tr><tr><td align="center">DATETIME</td><td align="center">8个字节</td></tr><tr><td align="center">TIMESTAMP</td><td align="center">4个字节</td></tr><tr><td align="center">CHAR(M)</td><td align="center">M字节,1 &lt;= M &lt;= 255</td></tr><tr><td align="center">VARCHAR(M)</td><td align="center">L+1字节,在此L &lt;= M1 &lt;= M &lt;= 255</td></tr></tbody></table><ul><li>以上选择原则主要是从下面两个角度考虑<ul><li>在对数据进行比较(查询条件、JOIN条件及排序)操作时:<br>同样的数据,字符处理往往比数字处理慢。</li><li>在数据库中,数据处理以页为单位,列的长度越小,利于性能提升。</li></ul></li></ul><h2 id="char-varchar-如何选择"><a href="#char-varchar-如何选择" class="headerlink" title="char varchar 如何选择"></a>char varchar 如何选择</h2><p>原则</p><ol><li>如果列中要存储的数据长度差不多是一致的,则应该考虑用char;否则应该考虑用varchar。</li><li>如果列中的最大数据长度小于50Byte,则一般也考虑用char。(当然,如果这个列很少用,则基于节省空间和减少I/O的考虑,还是可以选择用varchar)</li><li>一般不宜定义大于50 Byte的char类型列。</li></ol><h2 id="decimal与float-如何选择"><a href="#decimal与float-如何选择" class="headerlink" title="decimal与float 如何选择"></a>decimal与float 如何选择</h2><p>原则:</p><ol><li>decimal用于存储精确数据,而float只能用于存储非精确数据。故精确数据只能选择用decimal类型。</li><li>由于float的存储空间开销一般比decimal小(精确到7位小数只需要4个字节,而精确到15位小数只需要8字节)故非精确数据优先选择float类型。</li></ol><h2 id="时间类型如何存储"><a href="#时间类型如何存储" class="headerlink" title="时间类型如何存储"></a>时间类型如何存储</h2><p>使用int来存储时间字段的优缺点</p><ul><li>优点:字段长度比datetime小。</li><li>缺点:使用不方便,要进行函数转换。</li><li>限制<ul><li>只能存储到2038-1-19 11:14:07即2^32 为2147483648</li><li>需要存储的时间粒度<ul><li>年月日 小时 分 秒 周</li></ul></li></ul></li></ul><h1 id="如何选择主键"><a href="#如何选择主键" class="headerlink" title="如何选择主键"></a>如何选择主键</h1><p>区分业务主键和数据库主键</p><ol><li>业务主键用于标识业务数据,进行表与表之间的关联;数据库主键为了优化数据存储(Innodb会生成6个字节的隐含主键)</li><li>根据数据库的类型考虑主键是否要顺序增长<ul><li>有些数据库是按主键的顺序逻辑存储的</li></ul></li></ol><p>主键的字段类型所占空间要尽可能的小</p><p>对于使用聚集索引方式存储的表,每个索引后都会附加主键信息。</p><p>避免使用外键约束</p><ol><li>降低数据导入的效率</li><li>增加维护成本</li><li>虽然不建议使用外键约束,但是相关联的列上一定要建立索引</li></ol><p>避免使用触发器<br>:1. 降低数据导入的效率。<br>2. 可能会出现意想不到的数据异常。<br>3. 使业务逻辑变得复杂。</p><h1 id="关于预留字段"><a href="#关于预留字段" class="headerlink" title="关于预留字段"></a>关于预留字段</h1><p>原因</p><ol><li>无法准确的知道预留字段的类型。</li><li>无法准确的知道预留字段中所存储的内容。</li><li>后期维护预留字段所要的成本,同增加一个字段所需要的成本是相同的。</li><li>严禁使用预留字段。</li></ol></div><blockquote class="post-copyright"><div class="content"><span class="post-time">最后更新时间：<time datetime="2020-04-08T12:38:30.000Z" itemprop="dateUpdated">2020-04-08 20:38:30</time></span><br>本文链接：<a href="/posts/SQLstyle.html" target="_blank" rel="external">https://vitan.me/posts/SQLstyle.html</a></div><footer><a href="https://vitan.me"><img src="/img/ivitan.png" alt="Vitan"> Vitan</a></footer></blockquote><div class="page-reward"><a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a></div><div class="post-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li></ul></div></div><nav class="post-nav flex-row flex-justify-between"><div class="waves-block waves-effect prev"><a href="/posts/SQLlock.html" id="post-prev" class="post-nav-link"><div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div><h4 class="title">SQL 锁与并发控制</h4></a></div><div class="waves-block waves-effect next"><a href="/posts/SQLtrigger.html" id="post-next" class="post-nav-link"><div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div><h4 class="title">SQL 触发器</h4></a></div></nav><div class="comments vcomment" id="comments"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(e){return-1<GUEST_INFO.indexOf(e)});new Valine({el:"#comments",notify:!1,verify:!1,appId:"D33WPBHpBw2CjwdWpFvpUhDm-MdYXbMMI",appKey:"MzQtKvSeVPU4nS4ljd3zlbMp",avatar:"wavatar",placeholder:"Write a comment here.",guest_info:0==guest_info.length?GUEST_INFO:guest_info,pageSize:"10"})</script></article><div id="reward" class="page-modal reward-lay"><a class="close" href="javascript:;"><i class="icon icon-close"></i></a><h3 class="reward-title"><i class="icon icon-quote-left"></i> 感谢支持！ <i class="icon icon-quote-right"></i></h3><div class="reward-content"><div class="reward-code"><img id="rewardCode" src="/img/wechat.png" alt="打赏二维码"></div><label class="reward-toggle"><input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/wechat.png" data-alipay="/img/alipay.png"><div class="reward-toggle-ctrol"><span class="reward-toggle-item wechat">微信</span> <span class="reward-toggle-label"></span> <span class="reward-toggle-item alipay">支付宝</span></div></label></div></div><script src="//unpkg.com/jquery@latest/dist/jquery.min.js"></script><script src="/js/clipboard.min.js?v=1.7.2"></script><script src="/js/copy.min.js?v=1.7.2"></script></div><footer class="footer"><div class="top"><p><span id="busuanzi_container_site_uv" style="display:none">访客数：<span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" style="display:none">访问量：<span id="busuanzi_value_site_pv"></span></span></p><p><span><a href="/xml/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span> <span>内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 协议</a></span></p></div><div class="bottom"><p><span>Vitan &copy; 2017 - 2020</span> <span>Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/ivitan/indigo" target="_blank">indigo</a></span></p></div></footer></main><div class="mask" id="mask"></div><a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a><script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script><script>var BLOG={ROOT:"/",SHARE:!1,REWARD:!0}</script><script src="/js/main.min.js?v=1.7.2"></script><div class="search-panel" id="search-panel"><ul class="search-result" id="search-result"></ul></div><template id="search-tpl"><li class="item"><a href="{path}" class="waves-block waves-effect"><div class="title ellipsis" title="{title}">{title}</div><div class="flex-row flex-middle"><div class="tags ellipsis">{tags}</div><time class="flex-col time">{date}</time></div></a></li></template><script src="/js/search.min.js?v=1.7.2" async></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>