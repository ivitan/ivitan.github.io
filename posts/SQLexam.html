<!DOCTYPE html><html lang="zh-CN"><head>
<script>(n=>{"use strict";let r,s,e;const l=["cdn.jsdelivr.net","fastly.jsdelivr.net","gcore.jsdelivr.net","cdn.zenless.top","testingcf.jsdelivr.net","test1.jsdelivr.net"],t="//",a=l[0],i=Date.now(),o=2e3,c="jsdelivr-auto-fallback",f="/gh/PipecraftNet/jsdelivr-auto-fallback@main/empty.css?",d=e=>e&&e.includes(t+a),m=e=>e.replace(t+a,t+r),u=window.setTimeout,v=n.querySelectorAll.bind(n),g=()=>{let e,t;for(e of v('link[rel="stylesheet"]'))t=e.href,d(t)&&!t.includes(f)&&(e.href=m(t));for(e of v("script"))if(t=e.src,d(t)){const r=n.createElement("script");r.src=m(t),e.defer=!0,e.src="",e.before(r),e.remove()}for(e of v("img"))t=e.src,d(t)&&(e.src="",e.src=m(t));for(e of v("*[style]"))t=e.getAttribute("style"),d(t)&&e.setAttribute("style",m(t));for(e of v("style"))t=e.innerHTML,d(t)&&(e.innerHTML=m(t))},y=()=>{!e&&s&&r&&(console.warn(a+" is not available. Use "+r),e=!0,u(g,0),u(g,20),setInterval(g,500))},b=(()=>{try{return Object.assign({},JSON.parse(localStorage.getItem(c)||"{}"))}catch{return{}}})();var h=()=>{b.time=i,b.failed=!1,b.fastNode=null;for(const t of l)((e,t)=>{let r;const s=n.createElement("link"),l=e=>{r&&(clearTimeout(r),r=0,e||(s.href="data:text/plain;base64,"),s.remove(),t(e))};r=u(l,o),s.addEventListener("error",()=>l(!1)),s.addEventListener("load",()=>l(!0)),s.rel="stylesheet",s.text="text/css",s.href=e+f+i,n.head.insertAdjacentElement("afterbegin",s)})("https://"+t,e=>{e||t!==a||(s=!0,b.failed=!0),e&&!r&&(r=t),e&&!b.fastNode&&(b.fastNode=t),y()});u(()=>{s&&!r&&(r=l[1],y()),localStorage.setItem(c,JSON.stringify(b))},o+100)};b.time&&i-b.time<36e5&&b.failed&&b.fastNode?(s=!0,r=b.fastNode,y(),u(h,1e3)):h()})(document);</script><meta name="generator" content="Hexo 6.3.0"><meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.18.1"><meta charset="utf-8"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://fastly.jsdelivr.net"><link rel="preconnect" href="https://fastly.jsdelivr.net" crossorigin><link rel="dns-prefetch" href="//unpkg.com"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#f8f8f8"><title>SQL 上机实验题 - 楊咩阿</title><meta name="description" content="SQL 上机习题与练习"><meta property="og:type" content="article"><meta property="og:title" content="SQL 上机实验题"><meta property="og:url" content="https://ivitan.com/posts/SQLexam.html"><meta property="og:site_name" content="楊咩阿"><meta property="og:description" content="SQL 上机习题与练习"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55rpftisj20id0crq4i.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55qxojyqj20bu090di5.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55sk9nhsj209v0b541h.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55tj2m36j20bq0as41r.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5dx9sxmlj203o01uq2q.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5dzhztndj204t01la9t.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5e0nh2yvj20730213yc.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5e29ufetj206u023mwz.jpg"><meta property="article:published_time" content="2018-04-13T00:18:38.000Z"><meta property="article:modified_time" content="2022-12-14T19:06:50.259Z"><meta property="article:author" content="VITAN"><meta property="article:tag" content="SQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55rpftisj20id0crq4i.jpg"><link rel="alternate" href="/xml/atom.xml" title="楊咩阿" type="application/atom+xml"><link rel="stylesheet" href="/css/main.css"><link rel="shortcut icon" href="/assets/logo/favicon.svg"><script defer async src="https://www.googletagmanager.com/gtag/js?id=G-XEHQ8YBEN0"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XEHQ8YBEN0")</script></head><body><div class="l_body" id="start"><aside class="l_left" layout="post"><header class="header"><div class="logo-wrap"><a class="avatar" href="/"><div class="bg" style="opacity:0;background-image:url(https://fastly.jsdelivr.net/gh/cdn-x/placeholder@1.0.2/avatar/round/rainbow64@3x.webp)"></div><img no-lazy class="avatar" src="/assets/avatar/ivitan.png" onerror="javascript:this.classList.add('error');this.src='https://fastly.jsdelivr.net/gh/cdn-x/placeholder@1.0.1/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">楊咩阿</div><div class="sub normal cap">⁣⁣⁣Never Settle</div><div class="sub hover cap" style="opacity:0">ivitan.com</div></a></div><nav class="menu dis-select"><a class="nav-item active" href="/">主页</a><a class="nav-item" href="/wiki/">项目</a><a class="nav-item" href="/about/">关于</a></nav></header><div class="widgets"><widget class="widget-wrapper search"><div class="widget-body"><div class="search-wrapper" id="search"><form class="search-form"><input type="text" class="search-input" id="search-input" data-filter="/blog/" placeholder="文章搜索"><svg t="1670596976048" class="icon search-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2676" width="200" height="200"><path d="M938.2 832.6L723.8 618.1c-2.5-2.5-5.3-4.4-7.9-6.4 36.2-55.6 57.3-121.8 57.3-193.1C773.3 222.8 614.6 64 418.7 64S64 222.8 64 418.6c0 195.9 158.8 354.6 354.6 354.6 71.3 0 137.5-21.2 193.2-57.4 2 2.7 3.9 5.4 6.3 7.8L832.5 938c14.6 14.6 33.7 21.9 52.8 21.9 19.1 0 38.2-7.3 52.8-21.8 29.2-29.1 29.2-76.4 0.1-105.5M418.7 661.3C284.9 661.3 176 552.4 176 418.6 176 284.9 284.9 176 418.7 176c133.8 0 242.6 108.9 242.6 242.7 0 133.7-108.9 242.6-242.6 242.6" p-id="2677"></path></svg></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div></div></widget><widget class="widget-wrapper toc single" id="data-toc"><div class="widget-header cap dis-select"><span class="name">SQL 上机实验题</span></div><div class="widget-body fs14"><div class="doc-tree active"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E6%A0%87%EF%BC%9A"><span class="toc-text">实验目标：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9"><span class="toc-text">实验内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6"><span class="toc-text">1.	数据库文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-SQL-Server%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.	SQL Server系统数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89master%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">（1）master数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89model%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">（2）model数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89msdb%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">（3）msdb数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%884%EF%BC%89tempdb%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">（4）tempdb数据库</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">3.	创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">4.	修改数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">5.	删除数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%86%E7%A6%BB%E5%92%8C%E9%99%84%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">1.	分离和附件数据库</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E7%AD%94%E9%A2%98%EF%BC%9A"><span class="toc-text">简答题：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E6%A0%87%EF%BC%9A-1"><span class="toc-text">实验目标：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%EF%BC%9A"><span class="toc-text">实验内容：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E7%AD%94%E9%A2%98%EF%BC%9A-1"><span class="toc-text">简答题：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E6%A0%87%EF%BC%9A-2"><span class="toc-text">实验目标：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%EF%BC%9A-1"><span class="toc-text">实验内容：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E7%AD%94%E9%A2%98"><span class="toc-text">问答题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E6%A0%87%EF%BC%9A-3"><span class="toc-text">实验目标：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%EF%BC%9A-2"><span class="toc-text">实验内容：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E7%AD%94%E9%A2%98%EF%BC%9A"><span class="toc-text">问答题：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E6%A0%87%EF%BC%9A-4"><span class="toc-text">实验目标：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%EF%BC%9A-3"><span class="toc-text">实验内容：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E6%A0%87%EF%BC%9A-5"><span class="toc-text">实验目标：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%EF%BC%9A-4"><span class="toc-text">实验内容：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E6%A0%87%EF%BC%9A-6"><span class="toc-text">实验目标：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%EF%BC%9A-5"><span class="toc-text">实验内容：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E7%AD%94%E9%A2%98"><span class="toc-text">简答题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E6%A0%87%EF%BC%9A-7"><span class="toc-text">实验目标：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%EF%BC%9A-6"><span class="toc-text">实验内容：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E6%A0%87%EF%BC%9A-8"><span class="toc-text">实验目标：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84%EF%BC%9A"><span class="toc-text">实验目的：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%EF%BC%9A-7"><span class="toc-text">实验内容：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%9D%E8%80%83%E9%A2%98%EF%BC%9A"><span class="toc-text">思考题：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84%EF%BC%9A-1"><span class="toc-text">实验目的：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%EF%BC%9A-8"><span class="toc-text">实验内容：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E4%BC%98%E7%82%B9%EF%BC%9A"><span class="toc-text">存储过程的优点：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%8E%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-text">1．存储过程的分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%8E%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">2．如何创建存储过程</span></a></li></ol></li></ol></li></ol></div></div></widget><widget class="widget-wrapper search"><div class="widget-body"><div class="search-wrapper" id="search"><form class="search-form"><input type="text" class="search-input" id="search-input" placeholder="站内搜索"><svg t="1670596976048" class="icon search-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2676" width="200" height="200"><path d="M938.2 832.6L723.8 618.1c-2.5-2.5-5.3-4.4-7.9-6.4 36.2-55.6 57.3-121.8 57.3-193.1C773.3 222.8 614.6 64 418.7 64S64 222.8 64 418.6c0 195.9 158.8 354.6 354.6 354.6 71.3 0 137.5-21.2 193.2-57.4 2 2.7 3.9 5.4 6.3 7.8L832.5 938c14.6 14.6 33.7 21.9 52.8 21.9 19.1 0 38.2-7.3 52.8-21.8 29.2-29.1 29.2-76.4 0.1-105.5M418.7 661.3C284.9 661.3 176 552.4 176 418.6 176 284.9 284.9 176 418.7 176c133.8 0 242.6 108.9 242.6 242.7 0 133.7-108.9 242.6-242.6 242.6" p-id="2677"></path></svg></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div></div></widget></div></aside><div class="l_main"><div class="bread-nav fs12"><div id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a><span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/Database/">Database</a></div><div id="post-meta">发布于&nbsp;<time datetime="2018-04-13T00:18:38.000Z">2018-04-13</time></div></div><article class="md-text content post"><h1 class="article-title"><span>SQL 上机实验题</span></h1><p>SQL 上机习题与练习</p><span id="more"></span><h1 id="实验一-SQL-SERVER-2008的基本知识与操作"><a href="#实验一-SQL-SERVER-2008的基本知识与操作" class="headerlink" title="实验一   SQL SERVER 2008的基本知识与操作"></a>实验一 SQL SERVER 2008的基本知识与操作</h1><p>实验日期：</p><h2 id="实验目标："><a href="#实验目标：" class="headerlink" title="实验目标："></a>实验目标：</h2><p>（1）	以SQL Server2008为实验平台掌握SQL Server服务器的注册、启动、暂停、查看与设置服务器的属性等操作；</p><p>（2）	了解SQL Server Management Studio的功能</p><p>（3）	学习SQL Server2008所提供的系统数据库；</p><p>（4）	学习利用SQL Server Management Studio创建数据库。掌握数据库中这主数据文件、辅助数据文件、日志文件三类文件的作用；</p><p>（5）	学习利用SQL Server Management Studio数据库中创建表；创建表的字段、字段的数据类型、设置表的主键；</p><p>（6）	学习利用SQL Server Management Studio修改数据库中表的数据，删除表的数据、向表中插入数据；</p><p>（7）	利用SQL Server Management Studio删除数据库中的表；</p><p>（8）	利用SQL Server Management Studio删除数据库、分离数据库、附加数据库库。</p><h2 id="实验内容"><a href="#实验内容" class="headerlink" title="实验内容"></a>实验内容</h2><p>SQL Server 2008将数据保存在数据库中，并为用户提供了访问这些数据的接口。对数据库的基本操作包括创建、查看、修改和删除数据库等。在学习这些操作之前，先来了解一下数据库文件和SQL Server系统数据库。</p><h3 id="1-数据库文件"><a href="#1-数据库文件" class="headerlink" title="1.	数据库文件"></a>1.	数据库文件</h3><p>在SQL Server中数据库文件是存储数据的文件，其可以分为三类。</p><p>主数据文件：扩展名是.mdf，它包含数据库的启动信息以及数据库数据，每个数据库只能包含一个主数据文件。在SQL Server中数据的存储单位是页。</p><p>辅助数据文件：扩展名是.ndf,因为有些数据库可能非常大，用一个主数据文件可能放不下，因此就需要有一个多个辅助数据文件存储这些数据，可以和主数据文件放在相同的位置也可以存放在不同的位置。</p><p>日志文件：用来记录页的分配和释放以及对数据库数据的修改操作，扩展名为.ldf,包含用于恢复数据库的日志信息。每个数据库必须至少有一个日志文件，也可以有多个。</p><p>创建数据库时，一个数据库至少包含一个主数据文件和一个或多个日志文件，还可能包含一些辅助数据文件。这些文件默认的位置为：\program files\Microsoft SQL Server\MSSQL\Data文件夹。</p><h3 id="2-SQL-Server系统数据库"><a href="#2-SQL-Server系统数据库" class="headerlink" title="2.	SQL Server系统数据库"></a>2.	SQL Server系统数据库</h3><p>在 SQL Server 2008有两类数据库：系统数据库和用户数据库。系统数据库存储有关SQL Server 的系统信息，它们是SQL Server 2008管理数据库的依据。如果系统数据库遭到破坏，那么SQL Server将不能正常启动。在安装了SQL Server 2008的系统共中将创建4个可见系统数据库。</p><h4 id="（1）master数据库"><a href="#（1）master数据库" class="headerlink" title="（1）master数据库"></a>（1）master数据库</h4><p>master数据库是SQL Server中最重要的数据库，它是SQL Server的核心数据库，如果该数据库被损坏，SQL Server将无法正常工作，master数据库中包含所有的登录名或用户ID所属的角色、服务器中的数据库的名称及相关的信息、数据库的位置、SQL Server如何初始化四个方面的重要信息。</p><h4 id="（2）model数据库"><a href="#（2）model数据库" class="headerlink" title="（2）model数据库"></a>（2）model数据库</h4><p>用户创建数据库时是以一套预定义的标准为模型。例如，若希望所有的数据库都有确定的初始大小，或者都有特定的信息集，那么可以吧这些信息放在model数据库中，以model数据库作为其他数据库的模板数据库。如果想要使用所有的数据库都有一个特定的表，可以把该表放在model数据库里。model数据库是tempdb数据库的基础。对model数据库的任何改动都将反映在tempdb数据库中，所以，在决定对model数据库有所改变时，必须预先考虑好。</p><h4 id="（3）msdb数据库"><a href="#（3）msdb数据库" class="headerlink" title="（3）msdb数据库"></a>（3）msdb数据库</h4><p>msdb数据库给SQL Server代理提供必要的信息来运行作业，其供SQL Server 2008代理程序调度警报作业以及记录操作时使用。</p><h4 id="（4）tempdb数据库"><a href="#（4）tempdb数据库" class="headerlink" title="（4）tempdb数据库"></a>（4）tempdb数据库</h4><p>tempdb数据库用作系统的临时存储空间，其主要作用是存储用户建立的临时表和临时存储过程，存储用户说明的全局变量值，为数据排序创建临时表，存储用户利用游标说明所筛选出来的数据。</p><h3 id="3-创建数据库"><a href="#3-创建数据库" class="headerlink" title="3.	创建数据库"></a>3.	创建数据库</h3><p>选择开始菜单中→程序→【Management SQL Server 2008】→【SQL Server Management Studio】命令，打开【SQL Server Management Studio】窗口，并使用Windows或 SQL Server身份验证建立连接。</p><p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55rpftisj20id0crq4i.jpg"></p><p>图1.1 新建数据库</p><p>在【对象资源管理器】窗口中展开服务器，然后选择【数据库】节点。右键单击【数据库】节点，从弹出来的快捷菜单中选择【新建数据库】命令。执行上述操作后，会弹出【新建数据库】对话框。在对话框、左侧有3个选项，分别是【常规】、【选项】和【文件组】。完成这三个选项中的设置会后，就完成了数据库的创建工作，在【数据库名称】文本框中输入要新建数据库的名称。例如，这里以“Students”。<br>【数据库文件】列表中包括两行，一行是数据库文件，而另一行是日志文件。通过单击下面的【添加】、【删除】按钮添加或删除数据库文件，如图1.1。</p><p>【逻辑名称】指定该文件的文件名。</p><p>【文件类型】用于区别当前文件是数据文件还是日志文件。</p><p>【文件组】显示当前数据库文件所属的文件组。一个数据只能存在一个文件组里。</p><p>【初始大小】指定该文件的初始容量。默认值为3MB.日志默认值为1MB。</p><p>【自动增长】用于设置文件的容量不够用时，文件根据何中增长方式自动增长。</p><p>完成以上操作后，单击【确定】按钮关闭【新建数据库】对话框。至此“新建的数据”数据库创建成功。新建的数据库可以再【对象资源管理器】窗口看到，如下图1.2所示。</p><p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55qxojyqj20bu090di5.jpg"></p><p>图1.2建好后的数据库Students</p><h3 id="4-修改数据库"><a href="#4-修改数据库" class="headerlink" title="4.	修改数据库"></a>4.	修改数据库</h3><p>建立一个数据库之后，可以根据需要对该数据库的结构进行修改。</p><p>启动SSMS，在“对象资源管理器”窗格中展开数据库节点，右击要修改的数据库名称，在弹出的快捷菜单中选择“属性”命令，打开“数据库属性”对话框。可以通过修改数据库属性来修改数据库。修改数据库的操作包括增减数据库文件、修改文件属性（包括数据库的名称、大小和属性）、修改数据库选项等。</p><h3 id="5-删除数据库"><a href="#5-删除数据库" class="headerlink" title="5.	删除数据库"></a>5.	删除数据库</h3><p>为了减少系统资源的消耗，对于不再需要的用户创建数据库，应当把它从数据库服务器中删除，从而将其所占的磁盘空间全部释放掉。<br>删除数据库的具体操作如下：</p><p>启动SSMS，在“对象资源管理器”窗格中展开数据库节点，右击要删除的数据库名称，在弹出的快捷菜单中选择“删除”命令，打开“删除对象”对话框，单击“确定”按钮，数据库就被删除。</p><h4 id="1-分离和附件数据库"><a href="#1-分离和附件数据库" class="headerlink" title="1.	分离和附件数据库"></a>1.	分离和附件数据库</h4><p>当数据库需要从一台计算机移到另一台计算机，或者需要从一个物理磁盘移到另一个物理磁盘时，常要进行数据库的附加与分离操作。<br>附加数据库是指将当前数据库以外的数据库附加到当前数据库服务器中。<br>附加数据库的具体操作如下：</p><p>启动SSMS，在“对象资源管理器”窗格中右击“数据库”节点在快捷菜单中选择“附加”命令，打开“附加数据库”对话框，如图1.3所示，单击“添加”按钮，打开“定位数据库文件”对话框，选择要附加的数据库主数据文件（.mdf），单击“确定”按钮，返回上述“附加数据库”对话框，单击“确定”按钮，完成数据库的附加操作。</p><p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55sk9nhsj209v0b541h.jpg"></p><p>图1.3 附加数据库</p><p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq55tj2m36j20bq0as41r.jpg"></p><p>图1.4 分离数据库</p><p>分离数据库就是讲数据库从SQLserver2008服务器中卸载，但依然保存数据库的数据文件和日志文件。需要时，分离的数据库，可以重新附加到SQL server2008服务器中。</p><p>分离数据库的具体操作如下：</p><p>启动SSMS，在“对象资源管理器”窗格中展开数据库节点，右击要分离的数据库名称，在弹出的快捷菜单中单击“任务”→“分离”命令，如图1.4所示，打开“分离数据库”对话框，单击“确定”按钮，实现数据库的分离。</p><h2 id="简答题："><a href="#简答题：" class="headerlink" title="简答题："></a>简答题：</h2><p>（1）打开SQL Server Management Studio时，怎样进行数据库的登录认证？</p><p>答：</p><ol><li>打开 SQL Server Management Studio，以 Windows身份认证方式登录</li><li>在对象资源管理器下，右键 Security &#x3D;&#x3D;&gt; Logins &#x3D;&#x3D;&gt; New Login</li><li>点击图片中的Logins</li><li>会显示SQL server 的所有用户</li></ol><p>（2）对象资源管理器的作用是什么？<br>答：“对象资源管理器”是服务器中所有数据库对象的树视图。此树视图可以包括SQL Server Database Engine、Reporting Services、Analysis Services、Integration Services和SQL Server Mobile的数据库。对象资源管理器包括与其链接的所有服务器的信息。</p><h1 id="实验二-管理数据库操作"><a href="#实验二-管理数据库操作" class="headerlink" title="实验二   管理数据库操作"></a>实验二 管理数据库操作</h1><p>实验日期：</p><h2 id="实验目标：-1"><a href="#实验目标：-1" class="headerlink" title="实验目标："></a>实验目标：</h2><p>（1）熟练掌握用SQL语句创建数据库的方法。</p><p>（2）熟练掌握数据库属性的设置。</p><p>（3）掌握数据库的修改和删除方法。</p><h2 id="实验内容："><a href="#实验内容：" class="headerlink" title="实验内容："></a>实验内容：</h2><p>（1）利用SQL Server Management Studio创建一个”SM”的数据库，初始大小为3MB,最大为50MB，数据库自动增长，增长方式按10%；日志文件初始大小为2MB，最大值不受限制，按1MB增长。</p><p>（2）通过SQL语句创建一个名为“学籍”的数据库，指定主文件名为“学籍_data”，存储路径为“d:\example\学籍_data.mdf”，该数据文件的初始大小为10MB，最大为100MB，增长方式按10MB增长；指定主日志文件名为“学籍_log”，存储路径为“d:\example\学籍_log.ldf”，该日志文件初始大小为20MB，最大为200MB，按10MB增长。</p><p>①	在工具栏单击“新建查询”按钮，打开代码编辑器，输入如下SQL语句。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">Create</span> database 学籍</span><br><span class="line">   <span class="keyword">On</span>  <span class="keyword">primary</span></span><br><span class="line">(name<span class="operator">=</span>学籍_data,</span><br><span class="line">Filename<span class="operator">=</span>’d:\example\学籍_data.mdf’,</span><br><span class="line">Size<span class="operator">=</span><span class="number">10</span>,</span><br><span class="line">Maxsize<span class="operator">=</span><span class="number">100</span>,</span><br><span class="line">Filegrowth<span class="operator">=</span><span class="number">10</span>)</span><br><span class="line">Log <span class="keyword">on</span></span><br><span class="line">(name<span class="operator">=</span>学籍_log,</span><br><span class="line">Filename<span class="operator">=</span>’d:\example\学籍_log.ldf’,</span><br><span class="line">Size<span class="operator">=</span><span class="number">20</span>,</span><br><span class="line">Maxsize<span class="operator">=</span><span class="number">200</span>,</span><br><span class="line">Filegrowth<span class="operator">=</span><span class="number">10</span>)</span><br></pre></td></tr></table></figure><p>请执行该语句，即可创建“学籍”数据库。</p><p>② 使用对象资源管理器，可以修改“学籍”数据库。选择“学籍”数据库的节点，点击右键，在弹出的快捷菜单中选择“属性”命令，打开“数据库属性”对话框，即可进行数据库的修改操作。</p><p>③ 使用”SQL”语句，在“学籍”数据库中添加一个数据文件“学籍_data1”，指定其初始大小为4MB，最大不受限制，增长方式按10%增长。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Alter</span> database 学籍</span><br><span class="line"><span class="keyword">Add</span> file</span><br><span class="line">(name<span class="operator">=</span>’学籍_data1’,</span><br><span class="line">Filename<span class="operator">=</span>’d:\example\学籍_data1.mdf’,</span><br><span class="line">Size<span class="operator">=</span><span class="number">4</span>,</span><br><span class="line">Maxsize<span class="operator">=</span>unlimited,</span><br><span class="line">Filegrowth<span class="operator">=</span><span class="number">10</span><span class="operator">%</span>)</span><br><span class="line">Go</span><br></pre></td></tr></table></figure><p>④	使用SQL语句删除“学籍”数据库。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Drop</span> database 学籍</span><br><span class="line">GO</span><br></pre></td></tr></table></figure><p>提示：当数据库正在参与复制是不能删除，当数据库正在被复制时不能删除，当有用户正在使用数据库时不能删除。</p><h2 id="简答题：-1"><a href="#简答题：-1" class="headerlink" title="简答题："></a>简答题：</h2><p>（1）SQL Server2008中的数据库能否只包含数据文件？</p><h1 id="实验三-用T-SQL创建与修改表的操作"><a href="#实验三-用T-SQL创建与修改表的操作" class="headerlink" title="实验三   用T-SQL创建与修改表的操作"></a>实验三 用T-SQL创建与修改表的操作</h1><p>实验日期：</p><h2 id="实验目标：-2"><a href="#实验目标：-2" class="headerlink" title="实验目标："></a>实验目标：</h2><p>（1）熟练掌握各种数据类型。</p><p>（2）熟练运用T-SQL（Transact-SQL）语句正确创建表。</p><p>（3）掌握常用的数据完整性约束。</p><h2 id="实验内容：-1"><a href="#实验内容：-1" class="headerlink" title="实验内容："></a>实验内容：</h2><p>（1）创建“学籍”数据库，在该数据库中创建Student表。<br>表3.1 Student表的结构</p><table><thead><tr><th align="center">列名</th><th align="center">数据类型</th><th align="center">长度</th><th align="center">字段说明</th><th align="center">能否为空</th><th align="center">是否主键</th></tr></thead><tbody><tr><td align="center">Sno</td><td align="center">CHAR</td><td align="center">10</td><td align="center">学号</td><td align="center">否</td><td align="center">是</td></tr><tr><td align="center">Sname</td><td align="center">CHAR</td><td align="center">10</td><td align="center">姓名</td><td align="center">是</td><td align="center">否</td></tr><tr><td align="center">Ssex</td><td align="center">CHAR</td><td align="center">2</td><td align="center">性别</td><td align="center">是</td><td align="center">否</td></tr><tr><td align="center">Sage</td><td align="center"></td><td align="center">TINYINT</td><td align="center">年龄</td><td align="center">是</td><td align="center">否</td></tr><tr><td align="center">Sdept</td><td align="center">CHAR</td><td align="center">10</td><td align="center">系</td><td align="center">是</td><td align="center">否</td></tr></tbody></table><p>利用T-SQL命令创建Student表，表的结构如表3.1所示。<br>代码如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">TABLE</span>  Student</span><br><span class="line">( Sno  <span class="type">CHAR</span>(<span class="number">10</span>)  <span class="keyword">primary</span> key,</span><br><span class="line"> Sname  <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line"> Ssex  <span class="type">CHAR</span>(<span class="number">2</span>) <span class="keyword">check</span> (Ssex <span class="keyword">in</span> (‘男’,’女’)),</span><br><span class="line"> Sage  TINYINT,</span><br><span class="line"> Sdept  <span class="type">CHAR</span>(<span class="number">10</span>)</span><br><span class="line">  )</span><br></pre></td></tr></table></figure><p>（2）利用T-SQL命令创建Course表，表的结构如表3.2所示。</p><p>表3.2 Course表的结构</p><table><thead><tr><th align="center">列名</th><th align="center">数据类型</th><th align="center">长度</th><th align="center">字段说明</th><th align="center">能否为空</th><th align="center">是否主键</th></tr></thead><tbody><tr><td align="center">Cno</td><td align="center">CHAR</td><td align="center">5</td><td align="center">课程号</td><td align="center">否</td><td align="center">是</td></tr><tr><td align="center">Cname</td><td align="center">CHAR</td><td align="center">10</td><td align="center">课程名</td><td align="center">否</td><td align="center">否</td></tr><tr><td align="center">Credits</td><td align="center">TINYINT</td><td align="center"></td><td align="center">学分</td><td align="center">是</td><td align="center">否</td></tr><tr><td align="center">PCno</td><td align="center">CHAR</td><td align="center">5</td><td align="center">先修课程号</td><td align="center">是</td><td align="center">否</td></tr></tbody></table><p>代码如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Course (</span><br><span class="line">Cno     <span class="type">char</span>(<span class="number">5</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">Cname   <span class="type">char</span>(<span class="number">10</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> PCno    <span class="type">char</span>(<span class="number">5</span>),</span><br><span class="line">Credit  tinyint  <span class="keyword">CHECK</span> (Credit <span class="operator">&gt;</span> <span class="number">0</span>),</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY(Cno),</span><br><span class="line"><span class="keyword">FOREIGN</span> KEY (PCno) <span class="keyword">REFERENCES</span> Course(Cno),</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>（3）为已经创建了的Student表创建一个约束，规定在Student表中，如果学生没有提供所在系，就写入默认值“计算机系”。df_dept为该约束的名。<br>代码如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Alter</span> <span class="keyword">table</span> Student</span><br><span class="line"><span class="keyword">Add</span> <span class="keyword">constraint</span> df_dept</span><br><span class="line"><span class="keyword">Default</span>  ‘计算机系’  <span class="keyword">for</span>  Sdept</span><br></pre></td></tr></table></figure><p>（4）利用T-SQL命令创建SC表，表的结构如表3.3所示。<br>表3.3 SC表的结构</p><table><thead><tr><th align="center">列名</th><th align="center">数据类型</th><th align="center">长度</th><th align="center">字段说明</th><th align="center">能否为空</th><th align="center">是否主键</th></tr></thead><tbody><tr><td align="center">Sno</td><td align="center">CHAR</td><td align="center">10</td><td align="center">学号</td><td align="center">否</td><td align="center">是</td></tr><tr><td align="center">Cno</td><td align="center">CHAR</td><td align="center">5</td><td align="center">课程号</td><td align="center">否</td><td align="center">是</td></tr><tr><td align="center">Grade</td><td align="center">TINYINT</td><td align="center"></td><td align="center">成绩</td><td align="center">是</td><td align="center">否</td></tr></tbody></table><p>代码如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">TABLE</span>  SC(</span><br><span class="line">Sno <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">FOREIGN</span> KEY(Sno) <span class="keyword">REFERENCES</span> Student(Sno) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">Cno <span class="type">char</span>(<span class="number">5</span>)  <span class="keyword">FOREIGN</span> KEY(Cno) <span class="keyword">REFERENCES</span> Course(Cno),</span><br><span class="line">Grade tinyint <span class="keyword">CHECK</span>(grade<span class="operator">&lt;=</span><span class="number">100</span> <span class="keyword">and</span> grade<span class="operator">&gt;=</span><span class="number">0</span>),</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY(Sno,Cno)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>执行并思考Sno char(10) FOREIGN KEY(Sno) REFERENCES Student(Sno) ON DELETE CASCADE语句中ON DELETE CASCADE的含义与作用。</p><h2 id="问答题"><a href="#问答题" class="headerlink" title="问答题"></a>问答题</h2><p>（1）T-SQL支持的数据类型有哪些？</p><p>答：整数数据类型，浮点数据类型，字符型数据类型，日期和时间数据类型。</p><p>（2）Tinyint数据类型定义的数据的取值范围是多少？</p><p>存储0~255之间的整数</p><p>（3）写出创建以下表3.4-3.6所示的表结构的SQL语句，要求在定义表的同时定义数据的完整性约束。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> 图书表(  </span><br><span class="line">书号 <span class="type">nchar</span>(<span class="number">6</span>) <span class="keyword">primary</span> key,   </span><br><span class="line">书名 nvarchar(<span class="number">30</span>) <span class="keyword">not</span> <span class="keyword">null</span>,   </span><br><span class="line">第一作者 <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span>,   </span><br><span class="line">出版日期 smalldatetime,   </span><br><span class="line">价格：<span class="type">numeric</span>(<span class="number">4</span>,<span class="number">1</span>) )</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> 书店表(    </span><br><span class="line">书店编号 <span class="type">nchar</span>(<span class="number">6</span>) <span class="keyword">primary</span> key,   </span><br><span class="line">店名 nvarchar(<span class="number">30</span>) <span class="keyword">not</span> <span class="keyword">null</span>,    </span><br><span class="line">电话<span class="type">char</span>(<span class="number">8</span>) <span class="keyword">check</span>(电话 <span class="keyword">like</span>   ‘[<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>][<span class="number">0</span><span class="number">-9</span>] [<span class="number">0</span><span class="number">-9</span>]’),   </span><br><span class="line">地址 <span class="type">varchar</span>(<span class="number">40</span>),   </span><br><span class="line">邮政编码 <span class="type">char</span>(<span class="number">6</span>) ) </span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> 图书销售表(   </span><br><span class="line">书号 <span class="type">nchar</span>(<span class="number">6</span>) <span class="keyword">not</span> <span class="keyword">null</span>,    </span><br><span class="line">书店编号 <span class="type">nchar</span>(<span class="number">6</span>) <span class="keyword">not</span> <span class="keyword">null</span>,    </span><br><span class="line">销售日期 smalldatetime <span class="keyword">no</span> tnull,</span><br><span class="line">销售数量 smalldatetime <span class="keyword">check</span>(</span><br><span class="line">销售数量 <span class="operator">&gt;=</span> <span class="number">1</span>) )</span><br></pre></td></tr></table></figure><p>表3.4 图书表</p><table><thead><tr><th align="center">列名</th><th align="center">数据类型</th><th align="center">约束</th></tr></thead><tbody><tr><td align="center">书号</td><td align="center">统一字符编码定长类型，长度为6</td><td align="center">主键</td></tr><tr><td align="center">书名</td><td align="center">统一字符编码可变长类型，长度为30</td><td align="center">非空</td></tr><tr><td align="center">第一作者</td><td align="center">普通编码定长字符，长度为10</td><td align="center">非空</td></tr><tr><td align="center">出版日期</td><td align="center">小日期时间型</td><td align="center">非空</td></tr><tr><td align="center">价格</td><td align="center">定点小数，小数部分1位，整数部分3位</td><td align="center"></td></tr></tbody></table><p>表3.5 书店表</p><table><thead><tr><th align="center">列名</th><th align="center">数据类型</th><th align="center">约束</th></tr></thead><tbody><tr><td align="center">书店编号</td><td align="center">统一字符编码定长类型，长度为6</td><td align="center">主键</td></tr><tr><td align="center">店名</td><td align="center">字符编码可变长类型，长度为30</td><td align="center">非空</td></tr><tr><td align="center">电话</td><td align="center">普通编码定长字符类型，长度为8</td><td align="center"></td></tr><tr><td align="center">地址</td><td align="center">普通编码可变长字符类型，长度40</td><td align="center"></td></tr><tr><td align="center">邮政编码</td><td align="center">普通编码定长字符类型，长度6</td><td align="center"></td></tr></tbody></table><p>表3.6 销售表</p><table><thead><tr><th align="center">列名</th><th align="center">数据类型</th><th align="center">约束</th></tr></thead><tbody><tr><td align="center">书号</td><td align="center">统一字符编码定长类型，长度为6</td><td align="center">主键，外键</td></tr><tr><td align="center">书店编号</td><td align="center">统一字符编码定长类型，长度为6</td><td align="center">主键，外键</td></tr><tr><td align="center">销售日期</td><td align="center">小日期时间型</td><td align="center">主键</td></tr><tr><td align="center">销售数量</td><td align="center">小整型</td><td align="center"></td></tr><tr><td align="center">邮政编码</td><td align="center">普通编码定长字符类型，长度6</td><td align="center"></td></tr></tbody></table><p>（4）删除“销售表”中的“邮政编码”列；</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 书店表 <span class="keyword">Drop</span> <span class="keyword">column</span> 邮政编码</span><br></pre></td></tr></table></figure><p>（5）将“销售表”中的“销售数量”列的数据类型改为整型</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 图书销售表 <span class="keyword">Alter</span> <span class="keyword">column</span> 销售数量 <span class="type">int</span> </span><br></pre></td></tr></table></figure><h1 id="实验四-数据查询的操作（一）"><a href="#实验四-数据查询的操作（一）" class="headerlink" title="实验四   数据查询的操作（一）"></a>实验四 数据查询的操作（一）</h1><p>实验日期：</p><h2 id="实验目标：-3"><a href="#实验目标：-3" class="headerlink" title="实验目标："></a>实验目标：</h2><p>（1）掌握SELECT子句以及WHERE子句的使用方法。</p><p>（2）学会应用ORDER BY子句。</p><p>（3）掌握5种基本的聚合函数。</p><p>（4）学会分组统计和二次查询。</p><p>（5）学会数据的导入与导出的方法。</p><h2 id="实验内容：-2"><a href="#实验内容：-2" class="headerlink" title="实验内容："></a>实验内容：</h2><p>在SELECT语句中使用WHERE子句，在WHERE子句后跟一个条件式，就可以查询满足条件的行。<br>WHERE子句的格式：WHERE〈条件〉。<br>表4.1 常用的查询条件</p><table><thead><tr><th align="center">查询条件</th><th align="center">运算符</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">比较</td><td align="center">&#x3D;、&lt;、&lt;&#x3D;、&gt;、&gt;&#x3D;、&lt;&gt;、!&#x3D;、!&lt;、!&gt;</td><td align="center"></td></tr><tr><td align="center">范围谓词</td><td align="center">BETWEEN AND 、NOT BETWEEN AND</td><td align="center">介于二者之间（包括两端）、不介于二者之间</td></tr><tr><td align="center">集合谓词</td><td align="center">IN 、 NOT IN</td><td align="center">在集合中、不在集合中</td></tr><tr><td align="center">字符匹配谓词</td><td align="center">LIKE、NOT LIKE</td><td align="center">匹配、不匹配</td></tr><tr><td align="center">空值</td><td align="center">IS NULL 、IS NOT NULL</td><td align="center">是空值、不是空值</td></tr><tr><td align="center">逻辑运算</td><td align="center">NOT、AND、OR</td><td align="center">逻辑非、逻辑与、逻辑或</td></tr></tbody></table><p>打开对象资源管理器，创建一个名为”lianxi1”的数据库，在该数据库中导入以下的仓库表4.2和职工表4.3。<br>表4.2 仓库表</p><table><thead><tr><th align="center">仓库号</th><th align="center">城市</th><th align="center">面积</th></tr></thead><tbody><tr><td align="center">WH1</td><td align="center">北京</td><td align="center">370</td></tr><tr><td align="center">WH2</td><td align="center">上海</td><td align="center">500</td></tr><tr><td align="center">WH3</td><td align="center">广州</td><td align="center">200</td></tr><tr><td align="center">WH4</td><td align="center">广州</td><td align="center">300</td></tr><tr><td align="center">WH5</td><td align="center">天津</td><td align="center">340</td></tr><tr><td align="center">WH6</td><td align="center">上海</td><td align="center">350</td></tr><tr><td align="center">WH7</td><td align="center">上海</td><td align="center">600</td></tr><tr><td align="center">WH8</td><td align="center">天津</td><td align="center">300</td></tr></tbody></table><p>注意：面积以平方为单位。</p><p>表4.3 职工表</p><table><thead><tr><th align="center">职工号</th><th align="center">姓名</th><th align="center">仓库号</th><th align="center">月工资</th><th align="center">性别</th></tr></thead><tbody><tr><td align="center">E1</td><td align="center">朱迪</td><td align="center">WH2</td><td align="center">2220</td><td align="center">女</td></tr><tr><td align="center">E2</td><td align="center">牛丽丽</td><td align="center">WH1</td><td align="center">1810</td><td align="center">女</td></tr><tr><td align="center">E4</td><td align="center">李安</td><td align="center">WH2</td><td align="center">1850</td><td align="center">男</td></tr><tr><td align="center">E5</td><td align="center">王进步</td><td align="center">WH3</td><td align="center">1530</td><td align="center">男</td></tr><tr><td align="center">E6</td><td align="center">李光铭</td><td align="center">WH1</td><td align="center">1550</td><td align="center">男</td></tr><tr><td align="center">E7</td><td align="center">赵芙蓉</td><td align="center">WH4</td><td align="center">2300</td><td align="center">女</td></tr><tr><td align="center">E8</td><td align="center">刘山</td><td align="center">WH4</td><td align="center">2000</td><td align="center">男</td></tr><tr><td align="center">E9</td><td align="center">张尚琳</td><td align="center">WH5</td><td align="center">2050</td><td align="center">女</td></tr><tr><td align="center">E10</td><td align="center">王玛丽</td><td align="center">WH5</td><td align="center">1900</td><td align="center">女</td></tr><tr><td align="center">E11</td><td align="center">胡尼克</td><td align="center">WH6</td><td align="center">2100</td><td align="center">男</td></tr><tr><td align="center">E12</td><td align="center">古梅</td><td align="center">WH7</td><td align="center">1700</td><td align="center">女</td></tr><tr><td align="center">E15</td><td align="center">胡俊</td><td align="center">WH5</td><td align="center">1780</td><td align="center">男</td></tr><tr><td align="center">E16</td><td align="center">胡轩</td><td align="center">WH1</td><td align="center">1600</td><td align="center">男</td></tr></tbody></table><p>用SQL语句完成以下的练习题：<br>1.	从职工关系中检索所有工资值。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 月工资</span><br><span class="line"><span class="keyword">from</span> zg</span><br></pre></td></tr></table></figure><ol start="2"><li><pre><code>检索仓库关系中的所有元组。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> ck</span><br></pre></td></tr></table></figure></li><li><pre><code>检索工资多于2000元的职工对应的职工号，姓名。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  职工号,月工资 </span><br><span class="line"><span class="keyword">from</span> zg </span><br><span class="line"><span class="keyword">where</span> 月工资<span class="operator">&gt;</span><span class="number">2000</span></span><br></pre></td></tr></table></figure></li><li><pre><code>检索哪些仓库的面积在400到550平方之间，列出仓库号和所在的城市。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号,城市 </span><br><span class="line"><span class="keyword">from</span> ck </span><br><span class="line"><span class="keyword">where</span> 面积<span class="operator">&lt;=</span><span class="number">550</span> </span><br><span class="line"><span class="keyword">and</span> 面积<span class="operator">&gt;=</span><span class="number">400</span></span><br></pre></td></tr></table></figure></li><li><pre><code>检索出有广州哪些仓库，列出仓库号。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号</span><br><span class="line"><span class="keyword">from</span> ck </span><br><span class="line"><span class="keyword">where</span> 城市<span class="operator">=</span><span class="string">&#x27;广州&#x27;</span></span><br></pre></td></tr></table></figure></li><li><pre><code>检索出所在城市为广州的仓库的个数。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(仓库号)</span><br><span class="line"><span class="keyword">from</span> ck </span><br><span class="line"><span class="keyword">where</span> 城市<span class="operator">=</span><span class="string">&#x27;广州&#x27;</span></span><br></pre></td></tr></table></figure><ol start="7"><li><pre><code>检索出所有职工的平均工资。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(月工资) </span><br><span class="line"><span class="keyword">from</span> zg</span><br></pre></td></tr></table></figure><ol start="8"><li><pre><code>检索出在WH5仓库工作的职工的人数。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(职工号) </span><br><span class="line"><span class="keyword">from</span> zg </span><br><span class="line"><span class="keyword">where</span> 仓库号<span class="operator">=</span><span class="string">&#x27;WH5&#x27;</span></span><br></pre></td></tr></table></figure></li></ol></li></ol></li><li><pre><code>检索出职工表的所有的仓库号，去掉重复值。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> 仓库号 <span class="keyword">from</span> zg</span><br></pre></td></tr></table></figure><ol start="10"><li><pre><code>检索出每个仓库的人数。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> 人数 </span><br><span class="line"><span class="keyword">from</span> zg </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 仓库号</span><br></pre></td></tr></table></figure><ol start="11"><li><pre><code>检索出上海的仓库有哪些，列出仓库号、面积。查询结果按面积降序排列。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号,面积 </span><br><span class="line"><span class="keyword">from</span> ck </span><br><span class="line"><span class="keyword">where</span> 城市<span class="operator">=</span><span class="string">&#x27;上海&#x27;</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 面积</span><br></pre></td></tr></table></figure><ol start="12"><li><pre><code>检索出哪些仓库女职工的人数达到了3人。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号,<span class="built_in">count</span>(职工号)人数</span><br><span class="line"><span class="keyword">from</span> zg </span><br><span class="line"><span class="keyword">where</span> 性别<span class="operator">=</span><span class="string">&#x27;女&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 仓库号 </span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(职工号)<span class="operator">&gt;</span><span class="number">3</span></span><br></pre></td></tr></table></figure><ol start="13"><li><pre><code>检索出所有姓胡的职工的职工号、姓名、性别、工资。查询结果按性别排降序、工资排升序。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号,姓名,性别,月工资</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">where</span> 姓名 <span class="keyword">like</span><span class="string">&#x27;胡%&#x27;</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 性别 <span class="keyword">desc</span>,月工资 <span class="keyword">asc</span></span><br></pre></td></tr></table></figure><ol start="14"><li><pre><code>检索出职工“王玛丽”的年工资。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 月工资<span class="operator">*</span><span class="number">12</span> <span class="keyword">as</span> 年薪</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">where</span> 姓名<span class="operator">=</span><span class="string">&#x27;王玛丽&#x27;</span></span><br></pre></td></tr></table></figure><ol start="15"><li><pre><code>检索出“WH1”和“WH2”两个仓库工作的职工的基本信息。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">where</span> 仓库号<span class="operator">=</span><span class="string">&#x27;WH1&#x27;</span><span class="keyword">or</span> 仓库号<span class="operator">=</span><span class="string">&#x27;WH2&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="16"><li><pre><code>检索出年工资在24000以上的职工的姓名，年工资值。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 姓名</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">where</span> 月工资<span class="operator">*</span><span class="number">12</span><span class="operator">&gt;</span><span class="number">24000</span></span><br></pre></td></tr></table></figure></li></ol></li></ol></li></ol></li></ol></li></ol></li></ol></li></ol></li></ol><h2 id="问答题："><a href="#问答题：" class="headerlink" title="问答题："></a>问答题：</h2><p>（1）WHERE子句与HAVING子句有和不同？</p><p>答：Where子句–指定查询条件，having短语—选择出只有满足指定条件的组.</p><p>where 子句的作用是在对查询结果进行分组前，将不符合where条件的行去掉，即在分组之前过滤数据，条件中不能包含聚组函数，使用where条件显示特定的行。</p><p>  having 子句的作用是筛选满足条件的组，即在分组之后过滤数据，条件中经常包含聚组函数，使用having 条件显示特定的组，也可以使用多个分组标准进行分组。</p><p>（2）在WHERE子句中可以使用的运算符有哪些？WHERE子句中能不能使用聚集函数？</p><p>答：in，not in；字符匹配：like，not like；空值：is null，is not null；多重条件：and，or。<br>Where子句中不能使用聚集函数。</p><p>不能使用聚集函数  </p><h1 id="实验五-数据查询的操作（二）"><a href="#实验五-数据查询的操作（二）" class="headerlink" title="实验五   数据查询的操作（二）"></a>实验五 数据查询的操作（二）</h1><p>实验日期：</p><h2 id="实验目标：-4"><a href="#实验目标：-4" class="headerlink" title="实验目标："></a>实验目标：</h2><p>（1）熟练掌握基本的连接操作，掌握内连接与外连接的方法，学会应用自身连接。</p><p>（2）熟练掌握不相关子查询。</p><p>（3）掌握相关子查询。</p><p>（4）学会给表命别名。</p><p>（5）学会数据的导入与导出的方法。</p><h3 id="实验内容：-3"><a href="#实验内容：-3" class="headerlink" title="实验内容："></a>实验内容：</h3><p>打开对象资源管理器，创建一个名为”lianxi2”的数据库，在该数据库中导入以下的仓库表5.1、职工表5.2、订购表5.3和供应商表5.4。</p><p>表5.1仓库表</p><table><thead><tr><th align="center">仓库号</th><th align="center">城市</th><th align="center">面积</th></tr></thead><tbody><tr><td align="center">WH1</td><td align="center">北京</td><td align="center">3700</td></tr><tr><td align="center">WH2</td><td align="center">上海</td><td align="center">5000</td></tr><tr><td align="center">WH3</td><td align="center">广州</td><td align="center">2000</td></tr><tr><td align="center">WH4</td><td align="center">武汉</td><td align="center">4000</td></tr><tr><td align="center">WH5</td><td align="center">上海</td><td align="center">4560</td></tr><tr><td align="center">WH6</td><td align="center">广州</td><td align="center">6700</td></tr><tr><td align="center">WH7</td><td align="center">珠海</td><td align="center">4800</td></tr></tbody></table><p>表5.2职工表</p><table><thead><tr><th align="center">仓库号</th><th align="center">职工号</th><th align="center">月工资</th></tr></thead><tbody><tr><td align="center">WH2</td><td align="center">E1</td><td align="center">2220</td></tr><tr><td align="center">WH1</td><td align="center">E2</td><td align="center">2210</td></tr><tr><td align="center">WH2</td><td align="center">E3</td><td align="center">4050</td></tr><tr><td align="center">WH3</td><td align="center">E4</td><td align="center">3230</td></tr><tr><td align="center">WH1</td><td align="center">E5</td><td align="center">3250</td></tr><tr><td align="center">WH1</td><td align="center">E6</td><td align="center">2300</td></tr><tr><td align="center">WH4</td><td align="center">E7</td><td align="center">5000</td></tr><tr><td align="center">WH5</td><td align="center">E8</td><td align="center">4000</td></tr><tr><td align="center">WH5</td><td align="center">E9</td><td align="center">3400</td></tr><tr><td align="center">WH6</td><td align="center">E10</td><td align="center">3800</td></tr></tbody></table><p>表5.3 订购表</p><table><thead><tr><th align="center">职工号</th><th align="center">供应商号</th><th align="center">订购单号</th><th align="center">订购日期</th></tr></thead><tbody><tr><td align="center">E3</td><td align="center">S7</td><td align="center">OR091204</td><td align="center">2009-12-4</td></tr><tr><td align="center">E1</td><td align="center">S4</td><td align="center">OR090101</td><td align="center">2009-4-1</td></tr><tr><td align="center">E7</td><td align="center">S4</td><td align="center">OR100402</td><td align="center">2010-4-2</td></tr><tr><td align="center">E6</td><td align="center">S6</td><td align="center">OR100121</td><td align="center">2010-1-21</td></tr><tr><td align="center">E3</td><td align="center">S4</td><td align="center">OR091115</td><td align="center">2009-11-15</td></tr><tr><td align="center">E1</td><td align="center">S6</td><td align="center">OR060201</td><td align="center">2006-2-1</td></tr><tr><td align="center">E3</td><td align="center">S6</td><td align="center">OR100312</td><td align="center">2010-3-12</td></tr><tr><td align="center">E3</td><td align="center">S3</td><td align="center">OR090302</td><td align="center">2009-3-2</td></tr><tr><td align="center">E8</td><td align="center">S7</td><td align="center">OR100928</td><td align="center">2010-9-28</td></tr><tr><td align="center">E6</td><td align="center">S7</td><td align="center">OR100712</td><td align="center">2010-7-12</td></tr><tr><td align="center">E5</td><td align="center">S3</td><td align="center">OR100507</td><td align="center">2010-5-7</td></tr></tbody></table><p>表5.4 供应商表</p><table><thead><tr><th align="center">供应商号</th><th align="center">供应商名</th><th align="center">地址</th></tr></thead><tbody><tr><td align="center">S3</td><td align="center">振华电子厂</td><td align="center">西安</td></tr><tr><td align="center">S4</td><td align="center">华通电子公司</td><td align="center">北京</td></tr><tr><td align="center">S6</td><td align="center">607厂</td><td align="center">郑州</td></tr><tr><td align="center">S7</td><td align="center">爱华电子厂</td><td align="center">北京</td></tr></tbody></table><p>用SQL语句完成以下的练习题：</p><ol><li><pre><code>查询每个城市的仓库总面积。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 城市,<span class="built_in">sum</span>(面积) <span class="keyword">as</span> 总面积</span><br><span class="line"><span class="keyword">from</span> ck</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 城市</span><br></pre></td></tr></table></figure><ol start="2"><li><pre><code>查询每个仓库的职工人数，如果该仓库没有职工，也要列出人数为0。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号,<span class="built_in">count</span>(职工号) <span class="keyword">as</span> 职工人数</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 仓库号</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(职工号)<span class="operator">&gt;=</span><span class="number">0</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ck.仓库号,<span class="built_in">count</span>(职工号)<span class="keyword">as</span> 职工人数</span><br><span class="line"><span class="keyword">from</span> ck <span class="keyword">left</span> <span class="keyword">join</span> zg <span class="keyword">on</span> ck.仓库号<span class="operator">=</span>zg.仓库号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> ck.仓库号</span><br></pre></td></tr></table></figure><ol start="3"><li><pre><code>查询在上海工作的职工有多少个。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 城市,<span class="built_in">count</span>(职工号) <span class="keyword">as</span> 上海职工数</span><br><span class="line"><span class="keyword">from</span> ck,zg</span><br><span class="line"><span class="keyword">where</span> ck.仓库号<span class="operator">=</span>zg.仓库号</span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">ck.城市<span class="operator">=</span><span class="string">&#x27;上海&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 城市</span><br></pre></td></tr></table></figure><ol start="4"><li><pre><code>查询哪些职工在上海工作，列出他们的职工号，仓库号。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号,zg.仓库号</span><br><span class="line"><span class="keyword">from</span> ck,zg</span><br><span class="line"><span class="keyword">where</span> ck.城市<span class="operator">=</span><span class="string">&#x27;上海&#x27;</span> </span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">ck.仓库号<span class="operator">=</span>zg.仓库号</span><br></pre></td></tr></table></figure><ol start="5"><li><pre><code>查询与E3号职工有订购业务联系的供应商号，供应商名。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dg.供应商号,gys.供应商名</span><br><span class="line"><span class="keyword">from</span> dg,gys</span><br><span class="line"><span class="keyword">where</span> 职工号<span class="operator">=</span><span class="string">&#x27;E3&#x27;</span> <span class="keyword">and</span> dg.供应商号<span class="operator">=</span>gys.供应商号</span><br></pre></td></tr></table></figure><ol start="6"><li><pre><code>查询哪些职工与爱华电子厂有订购业务联系，列出他们的职工号，仓库号。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> zg.职工号,zg.仓库号</span><br><span class="line"><span class="keyword">from</span> zg,gy</span><br><span class="line"><span class="keyword">where</span> gy.供应商名<span class="operator">=</span><span class="string">&#x27;爱华电子厂&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> zg.职工号,zg.仓库号</span><br><span class="line"><span class="keyword">from</span> dg <span class="keyword">join</span> gys <span class="keyword">on</span> dg.供应商号<span class="operator">=</span>gys.供应商号</span><br><span class="line"><span class="keyword">join</span> zg <span class="keyword">on</span> zg.职工号<span class="operator">=</span>dg.职工号</span><br><span class="line"><span class="keyword">where</span> 供应商名<span class="operator">=</span><span class="string">&#x27;爱华电子厂&#x27;</span></span><br></pre></td></tr></table></figure><ol start="7"><li><pre><code>查询每个供应商的订购单数目，列出供应商号和他们的订购单数目。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dg.供应商号,<span class="built_in">count</span>(dg.订购单号) <span class="keyword">as</span> 订购单数目</span><br><span class="line"><span class="keyword">from</span> dg,gy</span><br><span class="line"><span class="keyword">where</span> gy.供应商号<span class="operator">=</span>dg.供应商号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> gy.供应商名,dg.供应商号</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dg.供应商号,<span class="built_in">count</span>(订购单号) 订购单数目</span><br><span class="line"><span class="keyword">from</span> dg <span class="keyword">join</span> gys <span class="keyword">on</span> dg.供应商号<span class="operator">=</span>gys.供应商号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> dg.供应商号</span><br></pre></td></tr></table></figure></li></ol></li></ol></li></ol></li></ol></li></ol></li></ol></li><li><pre><code>查询工资在3000元以上，并在北京或上海工作的职工，列出他们的职工号和工资。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> zg.职工号,zg.月工资</span><br><span class="line"><span class="keyword">from</span> zg,ck</span><br><span class="line"><span class="keyword">where</span> (ck.城市<span class="operator">=</span><span class="string">&#x27;北京&#x27;</span> <span class="keyword">or</span> ck.城市<span class="operator">=</span><span class="string">&#x27;上海&#x27;</span>)</span><br><span class="line"><span class="keyword">and</span> zg.月工资<span class="operator">&gt;</span><span class="number">3000</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号,月工资</span><br><span class="line"><span class="keyword">from</span> ck <span class="keyword">join</span> zg <span class="keyword">on</span> ck.仓库号<span class="operator">=</span>zg.仓库号</span><br><span class="line"><span class="keyword">where</span> (城市<span class="operator">=</span><span class="string">&#x27;北京&#x27;</span><span class="keyword">or</span> 城市<span class="operator">=</span><span class="string">&#x27;上海&#x27;</span>) <span class="keyword">and</span> 月工资<span class="operator">&gt;</span><span class="number">3000</span></span><br></pre></td></tr></table></figure><ol start="9"><li><pre><code>查询与供应商为S3的供应商有业务联系的职工他们的职工号、订购单号、仓库号、城市。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dg.职工号,dg.订购单号,ck.仓库号,ck.城市</span><br><span class="line"><span class="keyword">from</span> gys <span class="keyword">join</span> dg <span class="keyword">on</span> gys.供应商号<span class="operator">=</span>dg.供应商号</span><br><span class="line"><span class="keyword">join</span> zg <span class="keyword">on</span> dg.职工号<span class="operator">=</span>zg.职工号</span><br><span class="line"><span class="keyword">join</span> ck <span class="keyword">on</span> zg.仓库号<span class="operator">=</span>ck.仓库号</span><br><span class="line"><span class="keyword">where</span> gys.供应商号<span class="operator">=</span><span class="string">&#x27;S3&#x27;</span></span><br></pre></td></tr></table></figure><ol start="10"><li><pre><code>查询出哪些仓库没有分配职工。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ck.仓库号</span><br><span class="line"><span class="keyword">from</span> ck <span class="keyword">left</span> <span class="keyword">join</span> zg <span class="keyword">on</span> ck.仓库号<span class="operator">=</span>zg.仓库号</span><br><span class="line"><span class="keyword">where</span> zg.职工号 <span class="keyword">is</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ck.仓库号,<span class="built_in">count</span>(zg.仓库号) 人数</span><br><span class="line"><span class="keyword">from</span> ck <span class="keyword">left</span> <span class="keyword">join</span> zg <span class="keyword">on</span> zg.仓库号 <span class="operator">=</span> ck.仓库号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> ck.仓库号</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(zg.仓库号)<span class="operator">=</span><span class="number">0</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 仓库号</span><br><span class="line"><span class="keyword">from</span> ck</span><br><span class="line"><span class="keyword">where</span> 仓库号 <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> 仓库号 <span class="keyword">from</span> zg)</span><br></pre></td></tr></table></figure><ol start="11"><li><pre><code>查询出哪些职工的工资高于全体职工平均工资。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号</span><br><span class="line"><span class="keyword">from</span> zg</span><br><span class="line"><span class="keyword">where</span> 月工资<span class="operator">&gt;</span>(<span class="keyword">select</span> <span class="built_in">avg</span>(月工资) <span class="keyword">from</span> zg )</span><br></pre></td></tr></table></figure><ol start="12"><li><pre><code>查询出哪些职工的工资高于他所在仓库的职工的平均工资。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号</span><br><span class="line"><span class="keyword">from</span> zg <span class="keyword">join</span> </span><br><span class="line">(<span class="keyword">select</span> 仓库号 <span class="built_in">avg</span>(月工资) <span class="keyword">as</span> 平均工资</span><br><span class="line"><span class="keyword">from</span> zg <span class="keyword">group</span> <span class="keyword">by</span> 仓库号) <span class="keyword">as</span> a <span class="keyword">on</span> zg.仓库号<span class="operator">=</span>ck.职工号</span><br><span class="line"><span class="keyword">where</span> zg.月工资<span class="operator">&gt;</span>a.<span class="built_in">avg</span>(月工资)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号</span><br><span class="line"><span class="keyword">from</span> zg a</span><br><span class="line"><span class="keyword">where</span> 月工资<span class="operator">&gt;</span>(<span class="keyword">select</span> <span class="built_in">avg</span>(月工资) </span><br><span class="line"><span class="keyword">from</span> zg b</span><br><span class="line"><span class="keyword">where</span> b.仓库号<span class="operator">=</span>a.仓库号)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号</span><br><span class="line"><span class="keyword">from</span> zg <span class="keyword">as</span> a <span class="keyword">join</span></span><br><span class="line">(<span class="keyword">select</span> 仓库号,<span class="built_in">avg</span>(月工资) <span class="keyword">as</span> 平均工资 </span><br><span class="line"><span class="keyword">from</span> zg <span class="keyword">group</span> <span class="keyword">by</span> 仓库号)</span><br><span class="line"><span class="keyword">as</span> b <span class="keyword">on</span> a.仓库号<span class="operator">=</span>b.仓库号</span><br><span class="line"><span class="keyword">where</span> a.月工资<span class="operator">&gt;</span> b.平均工资</span><br></pre></td></tr></table></figure><ol start="13"><li><pre><code>求出哪个职工所发出的订购单最多。
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  top <span class="number">1</span> 职工号,<span class="built_in">count</span>(订购单号) <span class="keyword">as</span> 订购单数</span><br><span class="line"><span class="keyword">from</span> dg</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 职工号</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 订购单数 <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 职工号</span><br><span class="line"><span class="keyword">from</span> dg</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 职工号</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(订购单号)<span class="operator">=</span></span><br><span class="line">(<span class="keyword">select</span> top <span class="number">1</span> <span class="built_in">count</span>(订购单号) <span class="keyword">as</span> 订单数</span><br><span class="line"><span class="keyword">from</span> dg</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 职工号</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 订单数 <span class="keyword">desc</span>)</span><br></pre></td></tr></table></figure></li></ol></li></ol></li></ol></li></ol></li></ol></li></ol><h1 id="实验六-数据查询的操作（三）"><a href="#实验六-数据查询的操作（三）" class="headerlink" title="实验六   数据查询的操作（三）"></a>实验六 数据查询的操作（三）</h1><p>实验日期：</p><h2 id="实验目标：-5"><a href="#实验目标：-5" class="headerlink" title="实验目标："></a>实验目标：</h2><p>（1）熟练掌握基本的连接操作，掌握内连接与外连接的方法，学会应用自身连接。</p><p>（2）熟练掌握不相关子查询。</p><p>（3）掌握相关子查询。</p><p>（4）学会给表命别名。</p><p>（5）学会在FROM子句中派生关系，构造查询。</p><h2 id="实验内容：-4"><a href="#实验内容：-4" class="headerlink" title="实验内容："></a>实验内容：</h2><p>假设“教学管理”数据库中有4个基本表（关系）：</p><p>学生关系：学生（学号，姓名，性别，所在系）</p><p>课程关系：课程（课程号，课程名，开课学期，教师号）</p><p>选课关系：选课（学号，课程号，成绩）</p><p>教师关系：教师（教师号，姓名，职称，部门）</p><p>每个关系的当前值分别如表所示。</p><p>打开对象资源管理器，创建一个名为”教学管理”的数据库，在该数据库中导入以下的</p><p>表6.1—6.4。</p><p>表6.1 学生关系</p><table><thead><tr><th align="center">学号</th><th align="center">姓名</th><th align="center">性别</th><th align="left">年龄</th><th align="center">所在系</th></tr></thead><tbody><tr><td align="center">S101101</td><td align="center">陈名军</td><td align="center">男</td><td align="left">18</td><td align="center">计算机系</td></tr><tr><td align="center">S101102</td><td align="center">吴小晴</td><td align="center">女</td><td align="left">19</td><td align="center">计算机系</td></tr><tr><td align="center">S101103</td><td align="center">王明燕</td><td align="center">女</td><td align="left">19</td><td align="center">计算机系</td></tr><tr><td align="center">S101104</td><td align="center">严利</td><td align="center">男</td><td align="left">20</td><td align="center">计算机系</td></tr><tr><td align="center">S101105</td><td align="center">朱欣</td><td align="center">男</td><td align="left">20</td><td align="center">计算机系</td></tr><tr><td align="center">S101201</td><td align="center">李国庆</td><td align="center">男</td><td align="left">21</td><td align="center">信息系</td></tr><tr><td align="center">S101202</td><td align="center">李祥</td><td align="center">男</td><td align="left">21</td><td align="center">信息系</td></tr><tr><td align="center">S101203</td><td align="center">孙渝研</td><td align="center">男</td><td align="left">20</td><td align="center">信息系</td></tr><tr><td align="center">S101204</td><td align="center">赵艳</td><td align="center">女</td><td align="left">18</td><td align="center">信息系</td></tr><tr><td align="center">S101205</td><td align="center">刘唯</td><td align="center">女</td><td align="left">19</td><td align="center">信息系</td></tr><tr><td align="center">S101206</td><td align="center">林玉霞</td><td align="center">女</td><td align="left">20</td><td align="center">信息系</td></tr><tr><td align="center">S101207</td><td align="center">王江</td><td align="center">男</td><td align="left">21</td><td align="center">信息系</td></tr><tr><td align="center">S101301</td><td align="center">王成</td><td align="center">男</td><td align="left">20</td><td align="center">会计系</td></tr><tr><td align="center">S101302</td><td align="center">张平安</td><td align="center">男</td><td align="left">18</td><td align="center">会计系</td></tr><tr><td align="center">S101401</td><td align="center">钟琴</td><td align="center">女</td><td align="left">19</td><td align="center">会计系</td></tr><tr><td align="center">S101402</td><td align="center">吴娟娟</td><td align="center">女</td><td align="left">21</td><td align="center">会计系</td></tr><tr><td align="center">S101403</td><td align="center">李月</td><td align="center">女</td><td align="left">22</td><td align="center">会计系</td></tr><tr><td align="center">S101404</td><td align="center">陈名军</td><td align="center">男</td><td align="left">23</td><td align="center">会计系</td></tr><tr><td align="center">S101405</td><td align="center">赵艳</td><td align="center">女</td><td align="left">21</td><td align="center">会计系</td></tr></tbody></table><p>表6.2课程关系</p><table><thead><tr><th align="center">课程号</th><th align="center">课程名</th><th align="center">开课学期</th><th align="center">学分</th><th align="center">教师号</th></tr></thead><tbody><tr><td align="center">101</td><td align="center">计算机基础</td><td align="center">1</td><td align="center">3</td><td align="center">T1</td></tr><tr><td align="center">102</td><td align="center">体育</td><td align="center">2</td><td align="center">4</td><td align="center">T2</td></tr><tr><td align="center">201</td><td align="center">英语</td><td align="center">1</td><td align="center">4</td><td align="center">T3</td></tr><tr><td align="center">202</td><td align="center">大学语文</td><td align="center">3</td><td align="center">4</td><td align="center">T4</td></tr><tr><td align="center">305</td><td align="center">操作系统</td><td align="center">4</td><td align="center">4</td><td align="center">T5</td></tr><tr><td align="center">304</td><td align="center">计算机原理</td><td align="center">4</td><td align="center">4</td><td align="center">T5</td></tr><tr><td align="center">301</td><td align="center">计算机网络</td><td align="center">3</td><td align="center">3</td><td align="center">T6</td></tr><tr><td align="center">302</td><td align="center">电子技术</td><td align="center">3</td><td align="center">4</td><td align="center">T6</td></tr><tr><td align="center">303</td><td align="center">数据库应用</td><td align="center">4</td><td align="center">3</td><td align="center">T7</td></tr></tbody></table><p>表6.3 选课关系</p><table><thead><tr><th align="center">学号</th><th align="center">课程号</th><th align="center">成绩</th></tr></thead><tbody><tr><td align="center">S101101</td><td align="center">101</td><td align="center">60</td></tr><tr><td align="center">S101101</td><td align="center">102</td><td align="center">83</td></tr><tr><td align="center">S101101</td><td align="center">201</td><td align="center">78</td></tr><tr><td align="center">S101101</td><td align="center">305</td><td align="center">79</td></tr><tr><td align="center">S101101</td><td align="center">202</td><td align="center">87</td></tr><tr><td align="center">S101101</td><td align="center">304</td><td align="center">89</td></tr><tr><td align="center">S101101</td><td align="center">303</td><td align="center">64</td></tr><tr><td align="center">S101101</td><td align="center">302</td><td align="center">90</td></tr><tr><td align="center">S101102</td><td align="center">101</td><td align="center">84</td></tr><tr><td align="center">S101101</td><td align="center">301</td><td align="center">83</td></tr><tr><td align="center">S101102</td><td align="center">102</td><td align="center">75</td></tr><tr><td align="center">S101102</td><td align="center">202</td><td align="center">86</td></tr><tr><td align="center">S101102</td><td align="center">303</td><td align="center">67</td></tr><tr><td align="center">S101201</td><td align="center">101</td><td align="center">78</td></tr><tr><td align="center">S101201</td><td align="center">102</td><td align="center">72</td></tr><tr><td align="center">S101201</td><td align="center">303</td><td align="center">76</td></tr><tr><td align="center">S101201</td><td align="center">201</td><td align="center">50</td></tr><tr><td align="center">S101301</td><td align="center">101</td><td align="center">90</td></tr><tr><td align="center">S101302</td><td align="center">101</td><td align="center">90</td></tr><tr><td align="center">S101302</td><td align="center">303</td><td align="center">83</td></tr></tbody></table><p>表6.4教师表</p><table><thead><tr><th align="center">教师号</th><th align="center">姓名</th><th align="center">职称</th><th align="center">部门</th></tr></thead><tbody><tr><td align="center">T1</td><td align="center">胡美丽</td><td align="center">讲师</td><td align="center">公共教学</td></tr><tr><td align="center">T2</td><td align="center">王珊珊</td><td align="center">讲师</td><td align="center">公共教学</td></tr><tr><td align="center">T3</td><td align="center">王新</td><td align="center">讲师</td><td align="center">公共教学</td></tr><tr><td align="center">T4</td><td align="center">李再敏</td><td align="center">副教授</td><td align="center">公共教学</td></tr><tr><td align="center">T5</td><td align="center">李红玉</td><td align="center">教授</td><td align="center">计算机系</td></tr><tr><td align="center">T6</td><td align="center">周进</td><td align="center">助教</td><td align="center">计算机系</td></tr><tr><td align="center">T7</td><td align="center">张丽丽</td><td align="center">助教</td><td align="center">计算机系</td></tr><tr><td align="center">T8</td><td align="center">王晓舟</td><td align="center">副教授</td><td align="center">计算机系</td></tr><tr><td align="center">T9</td><td align="center">周樱</td><td align="center">讲师</td><td align="center">信息系</td></tr></tbody></table><ol><li><p>查询“101”课程成绩比“102”课程成绩高的所有学生的学号。<br>提示：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.学号</span><br><span class="line"><span class="keyword">From</span> (<span class="keyword">select</span> 学号,成绩 <span class="keyword">from</span> xkgx <span class="keyword">where</span> 课程号<span class="operator">=</span><span class="string">&#x27;101&#x27;</span>) a,</span><br><span class="line">(<span class="keyword">select</span> 学号,成绩</span><br><span class="line"><span class="keyword">from</span> xkgx <span class="keyword">where</span> 课程号<span class="operator">=</span><span class="string">&#x27;102&#x27;</span>) b</span><br><span class="line"><span class="keyword">where</span> a.成绩<span class="operator">&gt;</span>b.成绩 <span class="keyword">and</span> a.学号<span class="operator">=</span>b.学号</span><br></pre></td></tr></table></figure><p>自然连接：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.学号</span><br><span class="line"><span class="keyword">from</span> xkgx a <span class="keyword">join</span> xkgx b <span class="keyword">on</span> a.学号<span class="operator">=</span>b.学号</span><br><span class="line"><span class="keyword">where</span> a.课程号<span class="operator">=</span><span class="string">&#x27;101&#x27;</span> <span class="keyword">and</span> b.课程号<span class="operator">=</span><span class="string">&#x27;102&#x27;</span> </span><br><span class="line"><span class="keyword">and</span> a.成绩<span class="operator">&gt;</span>b.成绩</span><br></pre></td></tr></table></figure></li><li><p>查询全部选修课程表中所有课的同学的学号、姓名。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 学号,姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> 学号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx <span class="keyword">group</span> <span class="keyword">by</span> 学号 </span><br><span class="line"> <span class="keyword">having</span> <span class="built_in">count</span>(课程号)<span class="operator">=</span></span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">count</span>(课程号) <span class="keyword">from</span> kcgx))</span><br></pre></td></tr></table></figure></li><li><p>查询哪些老师没有教授任何课程。列出老师的全部列。（<code>not in</code>和<code>not EXISTS</code>两种方式实现）。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> js</span><br><span class="line"><span class="keyword">where</span> 教师号 <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 教师号 <span class="keyword">from</span> xkgx <span class="keyword">join</span> kcgx <span class="keyword">on</span> </span><br><span class="line">xkgx.课程号<span class="operator">=</span>kcgx.课程号)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> js</span><br><span class="line"><span class="keyword">where</span> 教师号 <span class="keyword">not</span> <span class="keyword">in</span> </span><br><span class="line">(<span class="keyword">select</span> 教师号 <span class="keyword">from</span> kcgx </span><br><span class="line"><span class="keyword">where</span> kcgx.教师号<span class="operator">=</span>jsgx.教师号)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> js</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">distinct</span> js.教师号  </span><br><span class="line"><span class="keyword">from</span> kcgx </span><br><span class="line"><span class="keyword">where</span> kcgx.教师号<span class="operator">=</span>js.教师号)</span><br></pre></td></tr></table></figure></li><li><p>查询出只选修了一门课程的学生的学号和姓名。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> xsgx.学号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> xkgx.学号 <span class="keyword">from</span> xkgx </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xkgx.学号 </span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(xkgx.课程号)<span class="operator">=</span><span class="number">1</span>)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,姓名</span><br><span class="line"><span class="keyword">from</span> xsgx <span class="keyword">join</span> xkgx <span class="keyword">on</span> xsgx.学号<span class="operator">=</span>xkgxx.学号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(xkgx.课程号)<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure></li><li><p>查询张丽丽老师教过的学生的学号、姓名。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> kcgx.课程号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 课程号 <span class="keyword">from</span> xkgx</span><br><span class="line"><span class="keyword">where</span> kcgx.教师号 <span class="keyword">in</span>(</span><br><span class="line"><span class="keyword">select</span> js.教师号</span><br><span class="line"><span class="keyword">from</span> js</span><br><span class="line"><span class="keyword">where</span> js.姓名<span class="operator">=</span><span class="string">&#x27;张丽丽&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx,kcgx,xkgx,js</span><br><span class="line"><span class="keyword">where</span> xsgx.学号<span class="operator">=</span>xkgx.学号 </span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">kcgx.课程号<span class="operator">=</span>xkgx.课程号 </span><br><span class="line"><span class="keyword">and</span></span><br><span class="line">js.教师号<span class="operator">=</span>kcgx.教师号</span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">js.姓名<span class="operator">=</span><span class="string">&#x27;张丽丽&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sxgx.学号,s.姓名</span><br><span class="line"><span class="keyword">from</span> js <span class="keyword">join</span> kcgx <span class="keyword">on</span> js.教师号<span class="operator">=</span>kcgx.教师号</span><br><span class="line"><span class="keyword">join</span> xkgx <span class="keyword">on</span> kcgx.课程号<span class="operator">=</span>xkgx.课程号</span><br><span class="line"><span class="keyword">join</span> xsgx <span class="keyword">on</span> xkgx.学号<span class="operator">=</span>xsgx.学号</span><br><span class="line"><span class="keyword">where</span> t.姓名<span class="operator">=</span><span class="string">&#x27;张丽丽&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xsgx.学号,xsgx.姓名</span><br></pre></td></tr></table></figure></li><li><p>查询相同姓名的学生，列出相同的姓名及相应的同名人数。（有几个学生同名）<br>提示：考虑按姓名分组，分组内元组的个数。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> 姓名 <span class="keyword">in</span>(<span class="keyword">select</span> 姓名 <span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 姓名</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>查询每门功成绩最好的前两名。</p></li></ol><p>提示：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t1.学号,t1.课程号,成绩</span><br><span class="line"><span class="keyword">FROM</span> 选课 t1</span><br><span class="line"><span class="keyword">WHERE</span> 成绩 <span class="keyword">IN</span> (<span class="keyword">SELECT</span> TOP <span class="number">2</span> 成绩</span><br><span class="line"><span class="keyword">FROM</span> 选课</span><br><span class="line"><span class="keyword">WHERE</span> 课程号<span class="operator">=</span> t1.课程号</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 成绩 <span class="keyword">DESC</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t1.学号,t1.课程号,成绩</span><br><span class="line"><span class="keyword">FROM</span> xkgx t1</span><br><span class="line"><span class="keyword">WHERE</span> 成绩 <span class="keyword">IN</span> (<span class="keyword">SELECT</span> TOP <span class="number">2</span> 成绩</span><br><span class="line"><span class="keyword">FROM</span> xkgx</span><br><span class="line"><span class="keyword">WHERE</span> 课程号<span class="operator">=</span> t1.课程号</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 成绩 <span class="keyword">DESC</span>)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 课程号 <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>这道题每次父亲查询都提供课程号的值给子查询，其子查询的功能就是计算父查询对应课程的前两名。</p><ol start="8"><li>查询学过“101”并且也学过编号“102”课程的同学的学号、姓名。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xkgx.学号</span><br><span class="line"><span class="keyword">where</span> 学号 <span class="keyword">in</span> (<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx</span><br><span class="line"><span class="keyword">where</span> 课程号<span class="operator">=</span><span class="string">&#x27;101&#x27;</span>)</span><br><span class="line"><span class="keyword">and</span> 学号 <span class="keyword">in</span> (<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx</span><br><span class="line"><span class="keyword">where</span> 课程号<span class="operator">=</span><span class="string">&#x27;102&#x27;</span>)</span><br></pre></td></tr></table></figure>9.查询没有选修课程表中所有课的同学的学号、姓名。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> 学号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 学号</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(课程号)<span class="operator">&lt;</span>(<span class="keyword">select</span> <span class="built_in">count</span>(课程号) <span class="keyword">from</span> kcgx))</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> xsgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xsgx <span class="keyword">join</span> xkgx <span class="keyword">on</span> xsgx.学号<span class="operator">=</span>xkgx.学号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xsgx.学号,xkgx.姓名</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(kcgs.课程号)<span class="operator">&lt;</span></span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">count</span> (课程号) <span class="keyword">from</span> kcgx )</span><br></pre></td></tr></table></figure>或者<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> kcgx.学号,xsgx.姓名</span><br><span class="line"><span class="keyword">from</span> xkgx <span class="keyword">join</span> xsgx <span class="keyword">on</span> xkgx.学号<span class="operator">=</span>xsgx.学号</span><br><span class="line"><span class="keyword">where</span> xkgx.学号 <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 学号</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(课程号) <span class="operator">=</span></span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">count</span> (课程号) <span class="keyword">from</span> kcgx))</span><br></pre></td></tr></table></figure>10.查询全部学生都选修过的课程对应的课程号和课程名。<br>提示：<br>意味着该课程的选课人数与学生总人数相等。考虑按课程号分组，查询哪个分组中学号的个数与学生个数相等，得到这样的分组它的课程号。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> kcgx.课程号,kcgx.课程名</span><br><span class="line"><span class="keyword">from</span> kcgx</span><br><span class="line"><span class="keyword">where</span> 课程号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 课程号 <span class="keyword">from</span> xkgx </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 课程号 </span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(学号)<span class="operator">=</span></span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">count</span>(学号) <span class="keyword">from</span> xsgx))</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 课程名,课程号</span><br><span class="line"><span class="keyword">from</span> kcgx</span><br><span class="line"><span class="keyword">where</span> kcgx.课程号 <span class="keyword">in</span> (<span class="keyword">select</span> 课程号</span><br><span class="line"><span class="keyword">from</span> xkgx</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 课程号</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(学号) <span class="operator">=</span></span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">count</span>(学号)<span class="keyword">from</span> xsgx))</span><br></pre></td></tr></table></figure></li></ol><p>11.查询没学过“李红玉”老师讲授的任一门课程的学生姓名。（not in不相关即可实现）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> 学号 <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx,js,kcgx </span><br><span class="line"><span class="keyword">where</span> xkgx.课程号<span class="operator">=</span>kcgx.课程号 </span><br><span class="line"><span class="keyword">and</span></span><br><span class="line">kcgx.教师号<span class="operator">=</span>js.教师号 </span><br><span class="line"><span class="keyword">and</span> </span><br><span class="line">js.姓名<span class="operator">=</span><span class="string">&#x27;李红玉&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 姓名</span><br><span class="line"><span class="keyword">from</span> xsgx</span><br><span class="line"><span class="keyword">where</span> 学号 <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 学号 <span class="keyword">from</span> xkgx </span><br><span class="line"><span class="keyword">join</span> kcgx <span class="keyword">on</span> xkgx.课程号<span class="operator">=</span>kcgx.课程号</span><br><span class="line"><span class="keyword">join</span> t <span class="keyword">on</span> kcgx.教师号<span class="operator">=</span>xkgx.教师号</span><br><span class="line"><span class="keyword">where</span> 姓名<span class="operator">=</span><span class="string">&#x27;李红玉&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="实验七-视图与索引"><a href="#实验七-视图与索引" class="headerlink" title="实验七   视图与索引"></a>实验七 视图与索引</h1><p>实验日期：</p><h2 id="实验目标：-6"><a href="#实验目标：-6" class="headerlink" title="实验目标："></a>实验目标：</h2><p>（1）掌握创建视图、删除视图；</p><p>（2）查询视图。</p><p>（3）更新视图、修改视图对应的数据。</p><p>（4）理解索引的概念和索引的作用，学会使用索引。</p><p>（5）了解聚簇索引和非聚簇索引。</p><h2 id="实验内容：-5"><a href="#实验内容：-5" class="headerlink" title="实验内容："></a>实验内容：</h2><p>假设“学生选课”数据库中有3个基本表（关系）：</p><p>学生关系：学生（学号，姓名，性别，所在系）</p><p>课程关系：课程（课程号，课程名，开课学期，教师号）</p><p>选课关系：选课（学号，课程号，成绩）</p><p>每个关系的当前值分别如表所示。</p><p>打开对象资源管理器，创建一个名为”学生选课”的数据库，在该数据库中导入以下的</p><p>表7.1—7.3。<br>表7.1 学生关系</p><table><thead><tr><th align="center">学号</th><th align="center">姓名</th><th align="center">性别</th><th align="center">年龄</th><th align="center">所在系</th></tr></thead><tbody><tr><td align="center">S101101</td><td align="center">陈名军</td><td align="center">男</td><td align="center">18</td><td align="center">计算机系</td></tr><tr><td align="center">S101102</td><td align="center">吴小晴</td><td align="center">女</td><td align="center">19</td><td align="center">计算机系</td></tr><tr><td align="center">S101103</td><td align="center">王明燕</td><td align="center">女</td><td align="center">19</td><td align="center">计算机系</td></tr><tr><td align="center">S101104</td><td align="center">严利</td><td align="center">男</td><td align="center">20</td><td align="center">计算机系</td></tr><tr><td align="center">S101105</td><td align="center">朱欣</td><td align="center">男</td><td align="center">20</td><td align="center">计算机系</td></tr><tr><td align="center">S101201</td><td align="center">李国庆</td><td align="center">男</td><td align="center">21</td><td align="center">信息系</td></tr><tr><td align="center">S101202</td><td align="center">李祥</td><td align="center">男</td><td align="center">21</td><td align="center">信息系</td></tr><tr><td align="center">S101203</td><td align="center">孙渝研</td><td align="center">男</td><td align="center">20</td><td align="center">信息系</td></tr><tr><td align="center">S101204</td><td align="center">赵艳</td><td align="center">女</td><td align="center">18</td><td align="center">信息系</td></tr><tr><td align="center">S101205</td><td align="center">刘唯</td><td align="center">女</td><td align="center">19</td><td align="center">信息系</td></tr><tr><td align="center">S101206</td><td align="center">林玉霞</td><td align="center">女</td><td align="center">20</td><td align="center">信息系</td></tr><tr><td align="center">S101207</td><td align="center">王江</td><td align="center">男</td><td align="center">21</td><td align="center">信息系</td></tr><tr><td align="center">S101301</td><td align="center">王成</td><td align="center">男</td><td align="center">20</td><td align="center">会计系</td></tr><tr><td align="center">S101302</td><td align="center">张平安</td><td align="center">男</td><td align="center">18</td><td align="center">会计系</td></tr><tr><td align="center">S101401</td><td align="center">钟琴</td><td align="center">女</td><td align="center">19</td><td align="center">会计系</td></tr><tr><td align="center">S101402</td><td align="center">吴娟娟</td><td align="center">女</td><td align="center">21</td><td align="center">会计系</td></tr><tr><td align="center">S101403</td><td align="center">李月</td><td align="center">女</td><td align="center">22</td><td align="center">会计系</td></tr><tr><td align="center">S101404</td><td align="center">陈名军</td><td align="center">男</td><td align="center">23</td><td align="center">会计系</td></tr><tr><td align="center">S101405</td><td align="center">赵艳</td><td align="center">女</td><td align="center">21</td><td align="center">会计系</td></tr></tbody></table><p>表7.2课程关系</p><table><thead><tr><th align="center">课程号</th><th align="center">课程名</th><th align="center">开课学期</th><th align="center">学分</th><th align="center">教师号</th></tr></thead><tbody><tr><td align="center">101</td><td align="center">计算机基础</td><td align="center">1</td><td align="center">3</td><td align="center">T1</td></tr><tr><td align="center">102</td><td align="center">体育</td><td align="center">2</td><td align="center">4</td><td align="center">T2</td></tr><tr><td align="center">201</td><td align="center">英语</td><td align="center">1</td><td align="center">4</td><td align="center">T3</td></tr><tr><td align="center">202</td><td align="center">大学语文</td><td align="center">3</td><td align="center">4</td><td align="center">T4</td></tr><tr><td align="center">305</td><td align="center">操作系统</td><td align="center">4</td><td align="center">4</td><td align="center">T5</td></tr><tr><td align="center">304</td><td align="center">计算机原理</td><td align="center">4</td><td align="center">4</td><td align="center">T5</td></tr><tr><td align="center">301</td><td align="center">计算机网络</td><td align="center">3</td><td align="center">3</td><td align="center">T6</td></tr><tr><td align="center">302</td><td align="center">电子技术</td><td align="center">3</td><td align="center">4</td><td align="center">T6</td></tr><tr><td align="center">303</td><td align="center">数据库应用</td><td align="center">4</td><td align="center">3</td><td align="center">T7</td></tr></tbody></table><p>表7.3 选课关系</p><table><thead><tr><th align="center">学号</th><th align="center">课程号</th><th align="center">成绩</th></tr></thead><tbody><tr><td align="center">S101101</td><td align="center">102</td><td align="center">83</td></tr><tr><td align="center">S101101</td><td align="center">101</td><td align="center">60</td></tr><tr><td align="center">S101101</td><td align="center">201</td><td align="center">78</td></tr><tr><td align="center">S101101</td><td align="center">202</td><td align="center">87</td></tr><tr><td align="center">S101101</td><td align="center">305</td><td align="center">79</td></tr><tr><td align="center">S101101</td><td align="center">304</td><td align="center">89</td></tr><tr><td align="center">S101101</td><td align="center">303</td><td align="center">64</td></tr><tr><td align="center">S101101</td><td align="center">302</td><td align="center">90</td></tr><tr><td align="center">S101101</td><td align="center">301</td><td align="center">83</td></tr><tr><td align="center">S101102</td><td align="center">101</td><td align="center">84</td></tr><tr><td align="center">S101102</td><td align="center">102</td><td align="center">75</td></tr><tr><td align="center">S101102</td><td align="center">202</td><td align="center">86</td></tr><tr><td align="center">S101102</td><td align="center">303</td><td align="center">67</td></tr><tr><td align="center">S101201</td><td align="center">101</td><td align="center">78</td></tr><tr><td align="center">S101201</td><td align="center">102</td><td align="center">72</td></tr><tr><td align="center">S101201</td><td align="center">303</td><td align="center">76</td></tr><tr><td align="center">S101201</td><td align="center">201</td><td align="center">50</td></tr><tr><td align="center">S101301</td><td align="center">101</td><td align="center">90</td></tr><tr><td align="center">S101302</td><td align="center">101</td><td align="center">90</td></tr><tr><td align="center">S101302</td><td align="center">303</td><td align="center">83</td></tr></tbody></table><p>用学生、课程、选课这三张表，利用SQL语句完成以下练习题。</p><p>（1）创建V1视图，学生的学号、姓名、所在系、课程号、课程名、课程学分的视图。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V1	</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> xs.学号,姓名,所在系,xk.课程号,kc.课程名,学分</span><br><span class="line"><span class="keyword">from</span> xs </span><br><span class="line"><span class="keyword">join</span> xk <span class="keyword">on</span> xs.学号<span class="operator">=</span>xk.学号 </span><br><span class="line"><span class="keyword">join</span> kc <span class="keyword">on</span> xk.课程号<span class="operator">=</span>kc.课程号</span><br></pre></td></tr></table></figure><p>（2）创建V2视图，查个学生的平均成绩的视图，要求列出学生学号及平均成绩。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V2</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> 学号,<span class="built_in">avg</span>(成绩) <span class="keyword">as</span> 平均成绩</span><br><span class="line"><span class="keyword">from</span> xk</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 学号</span><br></pre></td></tr></table></figure><p>（3）创建V3视图，每个学生的修课学分的视图，要求列出学生学号及总学分。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V3</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> 学号,<span class="built_in">sum</span>(学分) <span class="keyword">as</span> 总学分</span><br><span class="line"><span class="keyword">from</span> xk <span class="keyword">join</span>  kc <span class="keyword">on</span> xk.课程号<span class="operator">=</span>kc.课程号</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 学号</span><br></pre></td></tr></table></figure><p>（4）上面的视图V3能否对其总学分对应的数据进行修改？</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> V3 <span class="keyword">set</span> 总学分<span class="operator">=</span><span class="number">10</span> <span class="keyword">where</span> 学号<span class="operator">=</span><span class="string">&#x27;S101101&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> V3</span><br></pre></td></tr></table></figure><p>对视图或函数 ‘V3’ 的更新或插入失败，因其包含派生域或常量域。</p><p>（5）创建V4视图，计算机系的学生基本信息的视图。该视图能否更新学生的姓名？（无需选课的信息）。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V4</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> xs</span><br><span class="line"><span class="keyword">where</span> 所在系<span class="operator">=</span><span class="string">&#x27;计算机系&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> V4 <span class="keyword">set</span> 姓名<span class="operator">=</span><span class="string">&#x27;陈大军&#x27;</span> </span><br><span class="line"><span class="keyword">where</span> 姓名<span class="operator">=</span><span class="string">&#x27;陈名军&#x27;</span></span><br></pre></td></tr></table></figure><p>可以更新</p><p>（6）创建V5视图，每个学生获得的最高成绩，要求列出学号和最高成绩</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V5</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> 学号,<span class="built_in">max</span>(成绩) <span class="keyword">as</span> 最高成绩</span><br><span class="line"><span class="keyword">from</span> xk</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 学号</span><br></pre></td></tr></table></figure><p>（7）借助视图V5，实现该查询，对每个学生找出他获得最高成绩的课程号。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> V5.学号,课程号</span><br><span class="line"><span class="keyword">from</span> V5 <span class="keyword">join</span> xk <span class="keyword">on</span> V5.学号<span class="operator">=</span>xk.学号</span><br><span class="line"><span class="keyword">where</span> 成绩<span class="operator">=</span>top <span class="number">1</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> xk.课程号</span><br></pre></td></tr></table></figure><p>（8）删除视图V1。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> V1</span><br></pre></td></tr></table></figure><p>（9）为学生关系的姓名列创建一个非聚簇索引。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> nonclustered index 非聚簇索引 <span class="keyword">on</span> xs(姓名)</span><br></pre></td></tr></table></figure><p>（10）为课程表的课程名创建一个聚簇索引。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> clustered index 聚簇索引 <span class="keyword">on</span> kc(课程名)</span><br></pre></td></tr></table></figure><h2 id="简答题"><a href="#简答题" class="headerlink" title="简答题"></a>简答题</h2><ol><li>视图可以加快数据的查询速度，这句话对吗？为什么？</li></ol><ul><li>不对，因为通过视图查询数据时，比直接针对基本表查询数据多了一个转换过程，即从外模式到模式的转换。</li></ul><ol start="2"><li>视图可以简化查询，这句话对吗？为什么？</li></ol><ul><li>对，简化操作</li></ul><ol start="3"><li>视图是一个虚表，数据库中只存放视图的定义，而不存放视图包含的数据，这些数据仍存放在原来基本表中。这句话对吗？</li></ol><ul><li>对</li></ul><ol start="4"><li>基本表中的数据如果发生变化，视图中查询出数据也随之变化。这句话对吗？</li></ol><ul><li>对</li></ul><ol start="5"><li>索引是否越多越好？</li></ol><ul><li>否</li><li>索引需要在内存和物理磁盘驱动器上使用更多的存储空间。在执行插入声明的过程中可能会在一定程度上导致系统性能的下降，因为在插入数据的时候是需要根据索引的顺序插入，而不是在第一个可用的位置直接插入数据，这样一来，存在的索引越多将导致插入或者更新声明所需要的时间就越多。</li><li>1)索引影响DML操作,任何DML操作都要更新INDEX, 这是代价。</li><li>2)任何方便都是有代价的，select的时候方便，insert、update、delete的时候就要维护index。</li><li>3)索引多了, 执行计划的制定要费更多的资源。</li><li>4)创建和维护索引是有成本的。</li><li>5)索引能够极大的提高数据检索效率，也能够改善排序分组操作的性能，但是我们不能忽略的 一个问题就  是索引是完全独立于基础数据之外的一部分数据。</li></ul><ol start="6"><li>哪些视图不能更新？</li></ol><ul><li>若视图的属性来自集函数、表达式，则该视图肯定是不可以更新的</li><li>若视图是由两个以上基本表导出的，则次视图不允许更新。– 若视图的字段来自字段表达式或常数，则不允许对此视图执行INSERT和UPDATE操作，但允许执行DELETE操作。</li><li>若视图的字段来自集函数，则此视图不允许更新。</li><li>若视图定义中含有GROUP BY子句，则此视图不允许更新若视图中含有DISTINCT短语，则此视图不允许更新</li><li>若视图定义中有嵌套查询，并且内层查询FROM子句中涉及的表也是导出该视图的基本表，则此视图不允许更新。</li><li>一个不允许更新的视图上定义的视图也不允许更新。</li></ul><ol start="7"><li>聚簇索引和非聚簇索引有何区别，为什么每个表只能有一个聚簇索引？</li></ol><p>答：聚集索引是一种稀疏索引，数据页上一级的索引页存储的是页指针，而不是行指针。而对于非聚集索引，则是密集索引，在数据页的上一级索引页它为每一个数据行存储一条索引记录。一个表只能有一个聚簇索引，因为数据一旦存储，顺序只能有一种。</p><ul><li>聚簇索引</li></ul><p>(1) 一个索引项直接对应实际数据记录的存储页，可谓“直达”</p><p>(2) 主键缺省使用它</p><p>(3) 索引项的排序和数据行的存储排序完全一致，利用这一点，想修改数据的存储顺序，可以通过改变主键的方法（撤销原有主键，另找也能满足主键要求的一个字段或一组字段，重建主键）</p><p>(4) 一个表只能有一个聚簇索引（理由：数据一旦存储，顺序只能有一种）</p><ul><li>非聚簇索引</li></ul><p>(1) 不能“直达”，可能链式地访问多级页表后，才能定位到数据页</p><p>(2)一个表可以有多个非聚簇索引</p><ul><li>聚簇索引的顺序就是数据的物理存储顺序，而对非聚簇索引的解释是:索引顺序与数据物理排列顺序无关。正式因为如此，所以一个表最多只能有一个聚簇索引。</li></ul><h1 id="实验八-数据操作"><a href="#实验八-数据操作" class="headerlink" title="实验八   数据操作"></a>实验八 数据操作</h1><p>实验日期：</p><h2 id="实验目标：-7"><a href="#实验目标：-7" class="headerlink" title="实验目标："></a>实验目标：</h2><p>（1）掌握插入数据到表中。</p><p>（2）掌握删除表中的数据。</p><p>（3）掌握修改表中的数据。</p><h2 id="实验内容：-6"><a href="#实验内容：-6" class="headerlink" title="实验内容："></a>实验内容：</h2><p>建立一个名叫“仓库职工”的数据库，接下来请利用实验五的数据，将表中的数据导入到“仓库职工”数据库中。用T-SQL语句完成以下练习题。</p><ol><li>查询每个城市的仓库的总面积，将查询的结果插入到新表t1中，该表需要自己创建。<br>创建表t1的代码如下：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> t1</span><br><span class="line">(cityname <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">Sumarea <span class="type">int</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>运行代码创建了表t1。<br>接下来向t1中插入数据，其中数据为某个子查询的结果。代码提示如下：</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Insert</span> <span class="keyword">into</span> t1</span><br><span class="line"><span class="keyword">Select</span> 城市,<span class="built_in">sum</span>(面积)</span><br><span class="line"><span class="keyword">From</span> 仓库</span><br><span class="line"><span class="keyword">Group</span> <span class="keyword">by</span> 城市</span><br></pre></td></tr></table></figure><ol start="2"><li>插入一个新的供应商元组（S9，智通公司，沈阳）<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> 供应商表</span><br><span class="line"><span class="keyword">values</span> (<span class="string">&#x27;S9&#x27;</span>,<span class="string">&#x27;智通公司&#x27;</span>,<span class="string">&#x27;沈阳&#x27;</span>)</span><br></pre></td></tr></table></figure></li><li>北京的所有仓库增加100M2的面积。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">update</span> ck <span class="keyword">set</span> 面积<span class="operator">=</span>面积<span class="operator">+</span><span class="number">100</span> <span class="keyword">where</span> 城市<span class="operator">=</span><span class="string">&#x27;北京&#x27;</span></span><br></pre></td></tr></table></figure></li><li>给低于所有职工平均工资的职工提高5%（注意要用0.05表示5%）的工资。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> 职工表</span><br><span class="line"><span class="keyword">set</span> 月工资<span class="operator">=</span>月工资<span class="operator">*</span>(<span class="number">1</span><span class="operator">+</span><span class="number">0.005</span>)</span><br><span class="line"><span class="keyword">where</span> 月工资<span class="operator">&lt;</span></span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">avg</span>(月工资) <span class="keyword">from</span> 职工表)</span><br></pre></td></tr></table></figure></li><li>给北京的职工加900元工资。（相关子查询，不相关子查询，多表三种方法实现 ）。</li></ol><ul><li>用相关子查询实现的代码如下：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Update</span> 职工</span><br><span class="line"><span class="keyword">Set</span> 月工资<span class="operator">=</span>月工资<span class="operator">+</span><span class="number">900</span></span><br><span class="line"><span class="keyword">Where</span> ‘北京’<span class="operator">=</span>(<span class="keyword">select</span>  城市</span><br><span class="line"><span class="keyword">From</span> 仓库</span><br><span class="line"><span class="keyword">Where</span> 仓库.仓库号<span class="operator">=</span>职工.仓库号)</span><br></pre></td></tr></table></figure></li><li>用不相关子查询实现的代码如下：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Update</span> 职工</span><br><span class="line"><span class="keyword">Set</span> 月工资<span class="operator">=</span>月工资<span class="operator">+</span><span class="number">900</span></span><br><span class="line"><span class="keyword">Where</span> 仓库号<span class="operator">=</span>(<span class="keyword">select</span>  仓库号</span><br><span class="line"><span class="keyword">From</span> 仓库</span><br><span class="line"><span class="keyword">Where</span> 城市<span class="operator">=</span>’北京’)</span><br></pre></td></tr></table></figure>6．	删除目前没有任何订购单的供应商。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span>  <span class="keyword">from</span>  供应商表</span><br><span class="line"><span class="keyword">where</span> 供应商号 <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 供应商号 <span class="keyword">from</span> 订购表)</span><br></pre></td></tr></table></figure>7．	删除由在上海仓库工作的职工发出的所有订购单。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> 订购表</span><br><span class="line"><span class="keyword">where</span> 职工号 <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> 职工号 <span class="keyword">from</span> 职工表 <span class="keyword">where</span> 仓库号 <span class="keyword">in</span></span><br><span class="line">( <span class="keyword">select</span> 仓库号 <span class="keyword">from</span> 仓库表 <span class="keyword">where</span> 城市<span class="operator">=</span><span class="string">&#x27;上海&#x27;</span>))</span><br></pre></td></tr></table></figure></li></ul><h1 id="实验九-流程控制语句（选做）"><a href="#实验九-流程控制语句（选做）" class="headerlink" title="实验九   流程控制语句（选做）"></a>实验九 流程控制语句（选做）</h1><p>实验日期：</p><h2 id="实验目标：-8"><a href="#实验目标：-8" class="headerlink" title="实验目标："></a>实验目标：</h2><ul><li>（1）掌握流程控制关键字。</li><li>（2）查询流程控制关键字的使用方法。<br>实验内容：<br>流程控制语句是指那些用来控制程序执行和流程分支的语句，在SQL Server 2008中，流程控制语句用来控制SQL语句、语句块或者存储过程的执行流程。</li></ul><p>Transact-SQL 语言使用的流程控制命令与常见的程序设计语言类似，主要有以下几种控制命令。</p><p>假设有“学生选课”的数据库，数据如实验七。</p><p>（1）使用IF…ELSE 语句<br><code>IF...ELSE</code>语句是条件判断语句，其中，<code>ELSE子句</code>是可选的，最简单的IF语句没有ELSE子句部分。IF…ELSE语句用来判断当某一条件成立时执行某段程序，条件不成立时执行另一段程序。SQL Server允许嵌套使用IF…ELSE语句，而且嵌套层数没有限制。<br>IF…ELSE语句的语法形式为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IF <span class="operator">&lt;</span>布尔表达式<span class="operator">&gt;</span></span><br><span class="line">           <span class="operator">&lt;</span><span class="keyword">SQL</span>语句<span class="operator">&gt;</span><span class="operator">|</span><span class="operator">&lt;</span>语句块<span class="operator">&gt;</span></span><br><span class="line">     [<span class="keyword">ELSE</span></span><br><span class="line">          <span class="operator">&lt;</span><span class="keyword">SQL</span>语句<span class="operator">&gt;</span><span class="operator">|</span><span class="operator">&lt;</span>语句块<span class="operator">&gt;</span>]</span><br></pre></td></tr></table></figure><p>例 在Student表中查询是否有‘张力’这个学生。如果有，则显示这个学生的姓名和系，否则显示没有此人。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE 学生选课</span><br><span class="line">GO</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@message</span> <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">IF <span class="keyword">EXISTS</span>(<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Student <span class="keyword">WHERE</span> SNAME<span class="operator">=</span><span class="string">&#x27;张力&#x27;</span>)</span><br><span class="line">    <span class="keyword">SELECT</span> SNAME,SDEPT <span class="keyword">FROM</span> Student <span class="keyword">WHERE</span> SNAME<span class="operator">=</span><span class="string">&#x27;张力&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span>  </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SET</span> <span class="variable">@message</span><span class="operator">=</span><span class="string">&#x27;没有此人&#x27;</span></span><br><span class="line">    PRINT <span class="variable">@message</span></span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><p>例 在SC表中查询是否有成绩大于90分的学生，有则输出有学生的成绩高于90分，否则输出没有学生的成绩高于90分。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE STUDENTS</span><br><span class="line">GO</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@message</span> <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">IF <span class="keyword">EXISTS</span>(<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> SC <span class="keyword">WHERE</span> GRADE<span class="operator">&gt;</span><span class="number">90</span>)</span><br><span class="line">    PRINT <span class="string">&#x27;有学生的成绩高于90分&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span>  </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SET</span> <span class="variable">@message</span><span class="operator">=</span><span class="string">&#x27;抱歉，没有学生的成绩高于90分&#x27;</span>               PRINT <span class="variable">@message</span></span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><p>（2）使用<code>BEGIN...END</code> 语句<br>在控制流程中需要执行两条或两条以上的语句，应该将这些语句定义为一个语句块（称为复合语句）。BEGIN和END必须成对实现。<br>语法格式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"> <span class="operator">&lt;</span><span class="keyword">SQL</span>语句<span class="operator">&gt;</span><span class="operator">|</span><span class="operator">&lt;</span>语句块<span class="operator">&gt;</span></span><br><span class="line"> <span class="keyword">END</span></span><br></pre></td></tr></table></figure><p>（3）使用CASE语句<br>CASE结构提供比<code>IF……ELSE</code>结构更多的选择和判断的机会。使用CASE表达式可以很方便的实现多重选择的情况，从而可以避免编写多重的IF……ELSE嵌套循环。CASE语句按照使用形式不同，可以分为简单CASE语句和搜索CASE语句，它们的语法形式分别为：<br>1.	简单CASE函数：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CASE</span> <span class="operator">&lt;</span>表达式<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="operator">&lt;</span>表达式<span class="operator">&gt;</span> <span class="keyword">THEN</span> <span class="operator">&lt;</span>表达式<span class="operator">&gt;</span></span><br><span class="line">…</span><br><span class="line"><span class="keyword">WHEN</span> <span class="operator">&lt;</span>表达式<span class="operator">&gt;</span> <span class="keyword">THEN</span> <span class="operator">&lt;</span>表达式<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">ELSE</span> <span class="operator">&lt;</span>表达式<span class="operator">&gt;</span>]</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><p>例 从学生表Student中，选取SNO，SSEX，如果SSEX为“男”则输出“M”，如果为“女”输出“F”。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> SNO,SSEX<span class="operator">=</span></span><br><span class="line"><span class="keyword">CASE</span> SSEX</span><br><span class="line">		 <span class="keyword">WHEN</span> <span class="string">&#x27;男&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;M&#x27;</span></span><br><span class="line">		 <span class="keyword">WHEN</span> <span class="string">&#x27;女&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;F&#x27;</span></span><br><span class="line">  <span class="keyword">END</span></span><br><span class="line"><span class="keyword">FROM</span> Student</span><br></pre></td></tr></table></figure><p>运行结果如图8.10所示。<br>2.	CASE搜索函数：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CASE</span></span><br><span class="line">   <span class="keyword">WHEN</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span> <span class="keyword">THEN</span> <span class="operator">&lt;</span>表达式<span class="operator">&gt;</span></span><br><span class="line">	…</span><br><span class="line"><span class="keyword">WHEN</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span>                                      </span><br><span class="line"><span class="keyword">THEN</span> <span class="operator">&lt;</span>表达式<span class="operator">&gt;</span>                                  </span><br><span class="line">   [<span class="keyword">ELSE</span> <span class="operator">&lt;</span>表达式<span class="operator">&gt;</span>]</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><p>例 从SC表中查询所有同学选课成绩情况，凡成绩为空者输出“未考”、小于60分输出“不及格”、60分至70分输出“及格”、70分至90分输出“良好”、大于或等于90分时输出“优秀”。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> SNO,CNO,GRADE,</span><br><span class="line">GRADE<span class="operator">=</span><span class="keyword">CASE</span>  </span><br><span class="line">  <span class="keyword">WHEN</span> GRADE <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> <span class="string">&#x27;未考&#x27;</span></span><br><span class="line">  <span class="keyword">WHEN</span> GRADE<span class="operator">&lt;</span><span class="number">60</span> <span class="keyword">THEN</span> <span class="string">&#x27;不及格&#x27;</span></span><br><span class="line">  <span class="keyword">WHEN</span> GRADE<span class="operator">&gt;=</span><span class="number">60</span> <span class="keyword">AND</span> GRADE<span class="operator">&lt;</span><span class="number">70</span> <span class="keyword">THEN</span> <span class="string">&#x27;及格&#x27;</span></span><br><span class="line"> <span class="keyword">WHEN</span> GRADE<span class="operator">&gt;=</span><span class="number">70</span> <span class="keyword">AND</span> GRADE<span class="operator">&lt;</span><span class="number">90</span> <span class="keyword">THEN</span> <span class="string">&#x27;良好&#x27;</span></span><br><span class="line">  <span class="keyword">WHEN</span> GRADE<span class="operator">&gt;=</span><span class="number">90</span> <span class="keyword">THEN</span> <span class="string">&#x27;优秀&#x27;</span></span><br><span class="line">      <span class="keyword">END</span></span><br><span class="line"><span class="keyword">FROM</span> SC</span><br></pre></td></tr></table></figure><p>（4）使用循环：<code>WHILE语句</code><br>WHILE语句用来处理循环。在条件为<code>TRUE</code>的时候，重复执行一条或一个包含多条T-SQL语句的语句块，直到条件表达式为FALSE时退出循环体.<br>其语法如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">WHILE <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span></span><br><span class="line">	 [<span class="keyword">BEGIN</span>]</span><br><span class="line">	    <span class="operator">&lt;</span>程序块<span class="operator">&gt;</span></span><br><span class="line">	     [BREAK]</span><br><span class="line">	   [CONTINUE]</span><br><span class="line">	    [程序块]</span><br><span class="line">	 [<span class="keyword">END</span>]</span><br></pre></td></tr></table></figure><p>说明：CONTINUE 命令可以让程序跳过CONTINUE 命令之后的语句，回到WHILE 循环的第一行，继续进行下一次循环。BREAK 命令则让程序完全跳出循环，结束WHILE 命令的执行。<code>WHILE</code>语句也可以嵌套。<br>例 编程求1到100的和。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="variable">@i</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@sum</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@i</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@sum</span> <span class="operator">=</span><span class="number">0</span></span><br><span class="line">while <span class="variable">@i</span><span class="operator">&lt;=</span><span class="number">100</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">set</span> <span class="variable">@sum</span> <span class="operator">=</span><span class="variable">@sum</span><span class="operator">+</span><span class="variable">@i</span></span><br><span class="line">    <span class="keyword">set</span> <span class="variable">@i</span><span class="operator">=</span><span class="variable">@i</span><span class="operator">+</span><span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">select</span> <span class="variable">@sum</span> <span class="keyword">as</span> 合计 ,<span class="variable">@i</span> <span class="keyword">as</span> 循环数  </span><br></pre></td></tr></table></figure><p>图9.1运行结果如图9.1所示。</p><p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5dx9sxmlj203o01uq2q.jpg"></p><p>请读下列程序并回答下列程序的功能。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@i</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@i</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">WHILE (<span class="variable">@i</span> <span class="operator">&lt;</span> <span class="number">11</span>)    </span><br><span class="line">  <span class="keyword">BEGIN</span>                      </span><br><span class="line">    IF(<span class="variable">@i</span> <span class="operator">&lt;</span> <span class="number">5</span>)            </span><br><span class="line">    <span class="keyword">BEGIN</span>               </span><br><span class="line">		<span class="keyword">SET</span> <span class="variable">@i</span> <span class="operator">=</span> <span class="variable">@i</span> <span class="operator">+</span> <span class="number">1</span>                                 		 </span><br><span class="line">CONTINUE</span><br><span class="line">    <span class="keyword">END</span>       </span><br><span class="line">    PRINT <span class="variable">@i</span></span><br><span class="line">    <span class="keyword">SET</span> <span class="variable">@i</span> <span class="operator">=</span> <span class="variable">@i</span> <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">END</span></span><br></pre></td></tr></table></figure><p>（5）使用GOTO 语句<br><code>GOTO</code>：可以将执行流程改变到由标签指定的位置。系统跳过GOTO关键字之后的语句，并在GOTO 语句中指定的标签处继续执行操作。<br>语法：<br>GOTO 标识符<br>求1＋2＋3＋…＋10的总和。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@S</span> <span class="type">SMALLINT</span>,<span class="variable">@I</span> <span class="type">SMALLINT</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@I</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@S</span><span class="operator">=</span><span class="number">0</span></span><br><span class="line">BEG:</span><br><span class="line">IF (<span class="variable">@I</span><span class="operator">&lt;=</span><span class="number">10</span>)</span><br><span class="line">   <span class="keyword">BEGIN</span></span><br><span class="line">       <span class="keyword">SET</span> <span class="variable">@S</span><span class="operator">=</span><span class="variable">@S</span><span class="operator">+</span><span class="variable">@I</span></span><br><span class="line">       <span class="keyword">SET</span> <span class="variable">@I</span><span class="operator">=</span><span class="variable">@I</span><span class="operator">+</span><span class="number">1</span></span><br><span class="line">       GOTO BEG</span><br><span class="line">   <span class="keyword">END</span></span><br><span class="line">PRINT <span class="variable">@S</span></span><br></pre></td></tr></table></figure><p>运行结果如图9.2所示。</p><p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5dzhztndj204t01la9t.jpg"></p><p>（6）调度执行：WAIT FOR<br>该语句可以指定它以后的语句在某个时间间隔之后执行，或未来的某一时间执行。<br>语法如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WAIT  <span class="keyword">FOR</span>&#123;DELAY <span class="string">&#x27;time&#x27;</span><span class="operator">|</span><span class="type">TIME</span> <span class="string">&#x27;time&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><p>参数含义：<br><code>DELAY &#39;time&#39;</code>是指定SQL Server 等待的时间间隔，最长可达24小时。<br><code>TIME &#39;time&#39;</code>是指定SQL Server等待到某一时刻。<br>例 若变量<code>“@等待”</code>的值等于“间隔”，查询Studnet表是在等待2分钟后执行，否则在下午2:10执行。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> @等待 <span class="type">CHAR</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">SET</span> @等待<span class="operator">=</span> <span class="string">&#x27;间隔&#x27;</span></span><br><span class="line">IF @等待<span class="operator">=</span> <span class="string">&#x27;间隔&#x27;</span></span><br><span class="line">	<span class="keyword">BEGIN</span>  </span><br><span class="line">		WAITFOR DELAY <span class="string">&#x27;00:02:00&#x27;</span></span><br><span class="line">		<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> STUDENT</span><br><span class="line">	<span class="keyword">END</span></span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		WAITFOR <span class="type">TIME</span> <span class="string">&#x27;14:10:00&#x27;</span></span><br><span class="line">		<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> STUDENT</span><br><span class="line">	<span class="keyword">END</span></span><br></pre></td></tr></table></figure><h1 id="实验十-SQL-SERVER事务设计（选做）"><a href="#实验十-SQL-SERVER事务设计（选做）" class="headerlink" title="实验十  SQL SERVER事务设计（选做）"></a>实验十 SQL SERVER事务设计（选做）</h1><p>实验时间：</p><h2 id="实验目的："><a href="#实验目的：" class="headerlink" title="实验目的："></a>实验目的：</h2><ul><li>（1）通过实验理解事务的概念、特性，掌握事务的设计思想和事务创建、执行的方法；</li><li>（2）掌握事务的提交COMMIT；</li><li>（3）掌握事务的回滚ROLLBACK；</li><li>（4）了解事务的锁。</li></ul><h2 id="实验内容：-7"><a href="#实验内容：-7" class="headerlink" title="实验内容："></a>实验内容：</h2><p>创建一个名为“仓库职工”的数据库，导入以下的四张表到该数据库中，完成以下各题<br>仓库表</p><table><thead><tr><th align="center">仓库号</th><th align="left">城市</th><th align="center">面积</th></tr></thead><tbody><tr><td align="center">WH1</td><td align="left">北京</td><td align="center">370</td></tr><tr><td align="center">WH2</td><td align="left">上海</td><td align="center">500</td></tr><tr><td align="center">WH3</td><td align="left">广州</td><td align="center">200</td></tr><tr><td align="center">WH4</td><td align="left">武汉</td><td align="center">400</td></tr></tbody></table><p>职工表</p><table><thead><tr><th align="center">仓库号</th><th align="center">职工号</th><th align="center">工资</th></tr></thead><tbody><tr><td align="center">WH2</td><td align="center">E1</td><td align="center">1220</td></tr><tr><td align="center">WH1</td><td align="center">E2</td><td align="center">1210</td></tr><tr><td align="center">WH2</td><td align="center">E3</td><td align="center">1250</td></tr><tr><td align="center">WH3</td><td align="center">E4</td><td align="center">1230</td></tr><tr><td align="center">WH1</td><td align="center">E5</td><td align="center">1250</td></tr><tr><td align="center">WH3</td><td align="center">E6</td><td align="center">2000</td></tr><tr><td align="center">WH1</td><td align="center">E7</td><td align="center">2080</td></tr></tbody></table><p>订购表</p><table><thead><tr><th align="center">职工号</th><th align="center">供应商号</th><th align="center">订购单号</th><th align="center">订购日期</th></tr></thead><tbody><tr><td align="center">E3</td><td align="center">S7</td><td align="center">OR67</td><td align="center">2009-12-4</td></tr><tr><td align="center">E1</td><td align="center">S4</td><td align="center">OR73</td><td align="center">2009-4-1</td></tr><tr><td align="center">E7</td><td align="center">S4</td><td align="center">OR76</td><td align="center">2009-4-2</td></tr><tr><td align="center">E6</td><td align="center">S6</td><td align="center">OR77</td><td align="center">2009-1-21</td></tr><tr><td align="center">E3</td><td align="center">S4</td><td align="center">OR79</td><td align="center">2009-11-15</td></tr><tr><td align="center">E1</td><td align="center">S6</td><td align="center">OR80</td><td align="center">2009-2-1</td></tr><tr><td align="center">E3</td><td align="center">S6</td><td align="center">OR90</td><td align="center">2009-3-12</td></tr><tr><td align="center">E3</td><td align="center">S3</td><td align="center">OR91</td><td align="center">2009-3-2</td></tr></tbody></table><p>供应商表</p><table><thead><tr><th align="center">供应商号</th><th align="center">供应商名</th><th align="center">地址</th></tr></thead><tbody><tr><td align="center">S3</td><td align="center">振华电子厂</td><td align="center">西安</td></tr><tr><td align="center">S4</td><td align="center">华通电子公司</td><td align="center">北京</td></tr><tr><td align="center">S6</td><td align="center">607厂</td><td align="center">郑州</td></tr><tr><td align="center">S7</td><td align="center">爱华电子厂</td><td align="center">北京</td></tr><tr><td align="center">S8</td><td align="center">胖熊公司</td><td align="center">广州</td></tr><tr><td align="center">S9</td><td align="center">巧姑娘日化</td><td align="center">北京</td></tr></tbody></table><ol><li><pre><code>创建事务,并执行。功能为实现广州的职工加10%的工资.
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Begin</span> transaction</span><br><span class="line">Use cangku</span><br><span class="line">Go</span><br><span class="line"><span class="keyword">Update</span> 职工    <span class="keyword">set</span> 工资<span class="operator">=</span>工资<span class="operator">*</span><span class="number">1.1</span></span><br><span class="line"><span class="keyword">From</span> 职工,仓库       </span><br><span class="line"><span class="keyword">Where</span> 职工.仓库号<span class="operator">=</span>仓库.仓库号   <span class="keyword">and</span>  城市<span class="operator">=</span>’广州’</span><br><span class="line">Go</span><br><span class="line"><span class="keyword">Commit</span></span><br><span class="line">Go</span><br></pre></td></tr></table></figure>（2）在select 语句中加锁，悲观锁定职工表。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Begin</span> transaction</span><br><span class="line"><span class="keyword">Select</span>  <span class="operator">*</span> <span class="keyword">From</span>职工表<span class="keyword">with</span>(xlock)</span><br><span class="line"><span class="keyword">Insert</span> <span class="keyword">into</span> 职工表(仓库号,职工号)  <span class="keyword">values</span>(‘WH2’,’E10’)</span><br><span class="line"><span class="keyword">Update</span>  职工表  <span class="keyword">set</span> 工资<span class="operator">=</span><span class="number">2980</span></span><br><span class="line"><span class="keyword">Where</span> 仓库号<span class="operator">=</span>‘WH2’ <span class="keyword">and</span> 职工号<span class="operator">=</span>‘E10’</span><br><span class="line"><span class="keyword">Commit</span> transaction</span><br></pre></td></tr></table></figure>（3）使用HOLDLOCK对供应商表加共享锁。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Begin</span> transaction t2</span><br><span class="line"><span class="keyword">Select</span>  供应商号  <span class="keyword">From</span>  供应商表<span class="keyword">with</span>(holdlock)</span><br><span class="line"><span class="keyword">Select</span>  <span class="built_in">count</span>(供应商号)  <span class="keyword">From</span>  供应商表</span><br><span class="line"><span class="keyword">Commit</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="思考题："><a href="#思考题：" class="headerlink" title="思考题："></a>思考题：</h2><ol><li>什么是事务？事务和程序是一个概念吗？</li></ol><p>事务是由一系列访问和更新操作组成的程序执行单元</p><p>事务是应用程序中一系列严密的操作，所有操作必须成功完成，否则在每个操作中所作的所有更改都会被撤消。也就是事务具有原子性，一个事务中的一系列的操作要么全部成功，要么一个都不做。</p><p>不是同一概念<br> <br>2. 解释语句rollback和commit的作用。</p><p>Commit是提交事务，即提交某个事务的所有的操作；具体地说，就是将事务中所有对数据库的更新写回到磁盘上的物理数据库中去，事务正常结束。</p><p>Rollback表示回滚，即将事务运行的过程中发生了某种故障，事务不能继续执行，系统将事务中对数据库的所有已完成的操作全部撤销，回滚到事务开始的状态。<br>3. 为何使用事务？</p><p>答：通过事务，SQL Server能将逻辑相关的一组操作绑定在一起，以便服务器保持数据的完整性。主要用于一些对操作过程的完整性比较高的程序。比如银行系统，用户在转账的过程中程序出现错误，但是这个转账操作没有完成。那么这个操作就被退回。</p><ol start="4"><li>乐观锁和悲观锁的优缺点各是什么？</li></ol><p>答：<br>乐观锁:<br>优势是:乐观锁机制避免了长事务中的数据库加锁解锁开销，大大提升了大并发量下的系统整体性能表现；</p><p>劣势是，只能在提交数据时才发现业务事务将要失败，如果系统的冲突非常的多，而且一旦冲突就要因为重新计算提交而造成较大的代价的话，乐观锁也会带来很大的问题，在某些情况下，发现失败太迟的代价会非常的大。而且乐观锁也无法解决读”脏”数据的问题。</p><p>悲观锁:</p><p>优势是，能避免冲突的发生；</p><p>劣势是，开销较大，而且加锁时间较长，对于并发的访问性支持不好。</p><h1 id="实验十一-SQL-SERVER的存储过程（选做）"><a href="#实验十一-SQL-SERVER的存储过程（选做）" class="headerlink" title="实验十一  SQL SERVER的存储过程（选做）"></a>实验十一 SQL SERVER的存储过程（选做）</h1><p>实验时间：</p><h2 id="实验目的：-1"><a href="#实验目的：-1" class="headerlink" title="实验目的："></a>实验目的：</h2><p>（1）掌握存储过程的定义；<br>（2）掌握存储过程的有点；<br>（3）掌握定义带输入与输出参数的存储过程；<br>（4）调用存储过程。<br>（5）删除存储过程</p><h2 id="实验内容：-8"><a href="#实验内容：-8" class="headerlink" title="实验内容："></a>实验内容：</h2><p>注意：这次实验的示例数据库为学生选课数据库，请运行例题中的代码。</p><p>存储过程（procedure）类似于C语言中的函数，JAVA的方法。它可以重复调用。当存储过程执行一次后，可以将语句缓存中，这样下次执行的时候直接使用缓存中的语句。这样就可以提高存储过程的性能。<br>存储过程是一组编译在单个执行计划中的Transact-SQL语句，将一些固定的操作集中起来交给SQL Server数据库服务器完成，以实现某个任务。</p><h3 id="存储过程的优点："><a href="#存储过程的优点：" class="headerlink" title="存储过程的优点："></a>存储过程的优点：</h3><p>（1）与其他应用程序共享应用程序逻辑，因而确保了数据访问和修改的一致性。</p><p>（2）防止数据库中表的细节暴露给用户。</p><p>（3）提供安全机制。</p><p>（4）改进性能。</p><p>（5）减少网络流量。</p><h4 id="1．存储过程的分类"><a href="#1．存储过程的分类" class="headerlink" title="1．存储过程的分类"></a>1．存储过程的分类</h4><p>（1) 用户定义的存储过程</p><p>用户定义的<code>Transact-SQL</code>存储过程中包含一组<code>Transact-SQL</code> 语句集合，可以接受和返回用户提供的参数。</p><p>（2）扩展存储过程</p><p>扩展存储过程是指<code>Microsoft SQL Server</code>的实例可以动态加载和运行的 DLL，是由用户使用编程语言（例如C）创建的自己的外部例程，扩展存储过程一般使用<code>sp_</code>或<code>xp_</code>前缀。</p><p>（3）系统存储过程</p><p>由系统提供的存储过程，可以作为命令执行各种操作。系统存储过程定义在系统数据库master中，其前缀是sp_，例如常用的显示系统信息的sp_help存储过程。</p><h4 id="2．如何创建存储过程"><a href="#2．如何创建存储过程" class="headerlink" title="2．如何创建存储过程"></a>2．如何创建存储过程</h4><p>创建简单的存储过程的语法:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  PROC[EDURE]  存储过程名</span><br><span class="line">[<span class="keyword">WITH</span>  ENCRYPTION]</span><br><span class="line">[<span class="keyword">WITH</span>  RECOMPILE]</span><br><span class="line"><span class="keyword">AS</span></span><br></pre></td></tr></table></figure><p>SQL语句<br>说明：<code>WITH ENCRYPTION</code>–对存储过程进行加密，加密的存储过程用sp_helptext查看不到存储过程的原码；<code>WITH RECOMPILE</code>–对存储过程重新编译。<br>执行存储过程的语法：<br>EXEC 存储过程名<br>例 创建一个名为GetInfo存储过程，用于获取所有学生信息。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> GetInfo</span><br><span class="line"><span class="keyword">AS</span>  </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Student</span><br><span class="line">执行存储过程：</span><br><span class="line"><span class="keyword">EXEC</span> GetInfo</span><br></pre></td></tr></table></figure><p>接下来学习编写带参数的存储过程。上例中的存储过程可以获取所有学生信息，如果要获取指定学生的信息怎么做？这里就需要创建带参数的存储过程。</p><p>存储过程的参数分两种：输入参数和输出参数。输入参数用于向存储过程传入值，类似C语言的按值传递；输出参数用于在调用存储过程后返回结果，类似C语言的按引用传递；</p><p>带参数的存储过程的语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  PROC[EDURE]  存储过程名</span><br><span class="line">@参数<span class="number">1</span>  数据类型 <span class="operator">=</span> 默认值[OUTPUT],</span><br><span class="line">  …,</span><br><span class="line">@参数n  数据类型 <span class="operator">=</span> 默认值 [OUTPUT]</span><br><span class="line"><span class="keyword">AS</span></span><br></pre></td></tr></table></figure><p>SQL语句</p><p>例 创建一个带输入参数的存储过程，要求用于获取指定学生的信息。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> StuInfo</span><br><span class="line"><span class="variable">@name</span> <span class="type">CHAR</span>(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">   <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> STUDENT <span class="keyword">WHERE</span> SNAME<span class="operator">=</span><span class="variable">@name</span></span><br><span class="line">执行存储过程</span><br><span class="line"><span class="keyword">EXEC</span> StuInfo <span class="variable">@name</span><span class="operator">=</span><span class="string">&#x27;李晨&#x27;</span></span><br><span class="line">或按位置传递参数值</span><br><span class="line"><span class="keyword">EXEC</span> StuInfo <span class="string">&#x27;李晨&#x27;</span></span><br></pre></td></tr></table></figure><p>执行完毕的结果如图11.1所示：</p><p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5e0nh2yvj20730213yc.jpg"></p><p>图11.1执行存储过程结果<br>例 创建一个带输入和输出参数的存储过程GetScore，获取指定课程的平均成绩、最高成绩、最低成绩，并返回结果。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> GetScore</span><br><span class="line"><span class="variable">@kcID</span> <span class="type">CHAR</span>(<span class="number">10</span>),<span class="variable">@AVGScore</span> <span class="type">INT</span> OUTPUT,</span><br><span class="line"><span class="variable">@MAXScore</span> <span class="type">INT</span> OUTPUT,<span class="variable">@MINScore</span> <span class="type">INT</span> OUTPUT</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span>    <span class="variable">@AVGScore</span><span class="operator">=</span><span class="built_in">AVG</span>(Grade),<span class="variable">@MAXScore</span><span class="operator">=</span><span class="built_in">MAX</span>(Grade),<span class="variable">@MINScore</span><span class="operator">=</span><span class="built_in">MIN</span>(Grade)</span><br><span class="line"> <span class="keyword">FROM</span> SC</span><br><span class="line"> <span class="keyword">WHERE</span> Cno<span class="operator">=</span><span class="variable">@kcID</span></span><br><span class="line"> <span class="keyword">SELECT</span>  <span class="variable">@AVGScore</span> <span class="keyword">as</span> 平均成绩,<span class="variable">@MAXScore</span> <span class="keyword">as</span> 最高成绩,<span class="variable">@MINScore</span> <span class="keyword">as</span> 最低成绩</span><br><span class="line">执行存储过程</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@kcID</span> <span class="type">CHAR</span>(<span class="number">10</span>),<span class="variable">@AVGScore</span> <span class="type">INT</span>,<span class="variable">@MAXScore</span> <span class="type">INT</span>,<span class="variable">@MINScore</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@kcID</span><span class="operator">=</span><span class="string">&#x27;C001&#x27;</span></span><br><span class="line"><span class="keyword">EXEC</span> GetScore <span class="variable">@kcID</span>,<span class="variable">@AVGScore</span>,<span class="variable">@MAXScore</span>,<span class="variable">@MINScore</span></span><br></pre></td></tr></table></figure><p>执行完毕的结果如图8.20所示：</p><p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://ws1.sinaimg.cn/large/d71f8b2fgy1fq5e29ufetj206u023mwz.jpg"></p><p>图11.2 执行存储过程结果<br>3．查看存储过程<br>在SQL Server中，根据不同需要，可以使用<code>sp_helptext、sp_help</code>、<code>sp_depends</code>系统存储过程来查看用户自定义函数的不同信息。<br>例29. 查看Students数据库中存储过程GetInfo信息。<br>代码如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXEC</span> sp_helptext GetInfo</span><br><span class="line"><span class="keyword">EXEC</span> sp_help GetInfo</span><br><span class="line"><span class="keyword">EXEC</span> sp_depends GetInfo</span><br></pre></td></tr></table></figure><p>运行后得到存储过程的定义、参数和依赖信息。<br>4．存储过程的修改<br>修改存储过程是由ALTER语句来完成的，其语法如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">PROCEDURE</span> procedure_name</span><br><span class="line">[<span class="keyword">WITH</span> ENCRYPTION]</span><br><span class="line">[<span class="keyword">WITH</span> RECOMPILE]</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line">Sql_statement</span><br></pre></td></tr></table></figure><p>例 修改存储过程StuInfo，根据用户提供的系名进行统计这个系的人数，并要求加密。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">PROCEDURE</span> StuInfo</span><br><span class="line"><span class="variable">@dept</span> <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line"><span class="variable">@num</span> <span class="type">INT</span> OUTPUT</span><br><span class="line"><span class="keyword">WITH</span> ENCRYPTION</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@num</span><span class="operator">=</span><span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> Student <span class="keyword">WHERE</span> SDEPT<span class="operator">=</span><span class="variable">@dept</span></span><br><span class="line">PRINT <span class="variable">@num</span></span><br></pre></td></tr></table></figure><p>执行存储过程</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@dept</span> <span class="type">CHAR</span>(<span class="number">10</span>),<span class="variable">@num</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@dept</span><span class="operator">=</span><span class="string">&#x27;CS&#x27;</span></span><br><span class="line"><span class="keyword">EXEC</span> StuInfo <span class="variable">@dept</span>,<span class="variable">@num</span></span><br></pre></td></tr></table></figure><p>5．存储过程的删除</p><p>存储过程的删除是通过DROP语句来实现的。</p><p>例31. 使用Transact-SQL语句来删除存储过程StuInfo。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> StuInfo</span><br></pre></td></tr></table></figure><div class="article-footer reveal fs14"><section id="license"><div class="header"><span>许可协议</span></div><div class="body"><p>本文采用<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a>许可协议，转载请注明出处。</p></div></section></div></article><div class="related-wrap reveal" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/posts/Git-error.html">Git Push 错误解决方法</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/posts/Ubuntu-Theme.html">Ubuntu 美化</a></div></section></div><div class="related-wrap md-text reveal" id="comments"><section class="header cmt-title cap theme">快来参与讨论吧</section><section class="body cmt-body waline"><div id="waline_container" class="waline_thread"><svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg></div></section></div><footer class="page-footer reveal fs12"><hr><div class="text"><p>本站由 <a href="/">VITAN</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar">Stellar</a> 主题创建。<br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p></div></footer><div class="float-panel mobile-only blur" style="display:none"><button type="button" class="sidebar-toggle mobile" onclick="sidebar.toggle()"><svg class="icon" style="width:1em;height:1em;vertical-align:middle;fill:currentColor;overflow:hidden" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"></path><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"></path></svg></button></div></div></div><div class="scripts"><script defer type="text/javascript">const stellar={loadCSS:(e,s,t,n)=>{var l,i=window.document,a=i.createElement("link");if(s)l=s;else{var r=(i.body||i.getElementsByTagName("head")[0]).childNodes;l=r[r.length-1]}var o=i.styleSheets;if(n)for(var c in n)n.hasOwnProperty(c)&&a.setAttribute(c,n[c]);a.rel="stylesheet",a.href=e,a.media="only x",function e(s){if(i.body)return s();setTimeout((function(){e(s)}))}((function(){l.parentNode.insertBefore(a,s?l:l.nextSibling)}));var d=function(e){for(var s=a.href,t=o.length;t--;)if(o[t].href===s)return e();setTimeout((function(){d(e)}))};function p(){a.addEventListener&&a.removeEventListener("load",p),a.media=t||"all"}return a.addEventListener&&a.addEventListener("load",p),a.onloadcssdefined=d,d(p),a},loadScript:(e,s)=>new Promise((t,n)=>{var l=document.createElement("script");if(l.src=e,s)for(let e of Object.keys(s))l[e]=s[e];else l.async=!0;l.onerror=n,l.onload=l.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(l.onload=l.onreadystatechange=null,t())},document.head.appendChild(l)}),jQuery:e=>{"undefined"==typeof jQuery?stellar.loadScript(stellar.plugins.jQuery).then(e):e()},version:"1.18.1",github:"https://github.com/xaoxuu/hexo-theme-stellar/tree/1.18.1",config:{date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"}},plugins:{jQuery:"https://fastly.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"},search:{}};if(stellar.search.service="local_search","local_search"==stellar.search.service){let e=Object.assign({},{field:"all",path:"/search.json",content:!0,codeblock:!0,sort:"-date"});stellar.search[stellar.search.service]=e}stellar.plugins.stellar=Object.assign({sites:"/js/plugins/sites.js",friends:"/js/plugins/friends.js",ghinfo:"/js/plugins/ghinfo.js",timeline:"/js/plugins/timeline.js",linkcard:"/js/plugins/linkcard.js",fcircle:"/js/plugins/fcircle.js",weibo:"/js/plugins/weibo.js"}),stellar.plugins.marked=Object.assign("https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js"),stellar.plugins.lazyload=Object.assign({enable:!0,js:"https://fastly.jsdelivr.net/npm/vanilla-lazyload@17.3.1/dist/lazyload.min.js",transition:"blur"}),stellar.plugins.swiper=Object.assign({enable:!0,css:"https://unpkg.com/swiper@6/swiper-bundle.min.css",js:"https://unpkg.com/swiper@6/swiper-bundle.min.js"}),stellar.plugins.preload=Object.assign({enable:!0,service:"flying_pages",instant_page:"https://fastly.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js",flying_pages:"https://fastly.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"}),stellar.plugins.fancybox=Object.assign({enable:!0,js:"https://fastly.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js",css:"https://fastly.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css",selector:".swiper-slide img"})</script><script defer src="/js/main.js" async></script><script>function load_comment(){document.getElementById("waline_container")&&(stellar.loadCSS("https://unpkg.com/@waline/client@v2/dist/waline.css"),stellar.loadScript("https://unpkg.com/@waline/client@v2/dist/waline.js",{defer:!0}).then((function(){var e=document.getElementById("waline_container").getAttribute("comment_id");e||(e=decodeURI(window.location.pathname)),Waline.init(Object.assign({js:"https://unpkg.com/@waline/client@v2/dist/waline.js",css:"https://unpkg.com/@waline/client@v2/dist/waline.css",serverURL:"https://comment.ivitan.com",commentCount:!0,pageview:!1},{el:"#waline_container",path:e}))})))}window.addEventListener("DOMContentLoaded",e=>{console.log("DOM fully loaded and parsed"),load_comment()})</script></div></body></html>