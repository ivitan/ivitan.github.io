<!DOCTYPE html><html><head><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-144334903-1","auto"),ga("send","pageview")</script><script async src="https://www.google-analytics.com/analytics.js"></script><script data-ad-client="ca-pub-2581760538335948" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><meta charset="utf-8"><meta name="sogou_site_verification" content="ivC590WMZh"><link rel="canonical" href="https://vitan.me/posts/H3C.html"><title>H3C 交换机常用命令 - 楊咩呀</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#f45a8d"><meta name="keywords" content="Switch,Network"><meta name="description" content="H3C 交换机常用命令"><meta property="og:type" content="article"><meta property="og:title" content="H3C 交换机常用命令"><meta property="og:url" content="https://vitan.me/posts/H3C.html"><meta property="og:site_name" content="楊咩呀"><meta property="og:description" content="H3C 交换机常用命令"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-05-15T07:27:38.000Z"><meta property="article:modified_time" content="2020-09-13T03:21:39.873Z"><meta property="article:author" content="VITAN"><meta property="article:tag" content="Switch"><meta property="article:tag" content="Network"><meta name="twitter:card" content="summary"><link rel="alternate" type="application/atom+xml" title="楊咩呀" href="/xml/atom.xml"><link rel="shortcut icon" href="/img/favicon.svg"><link rel="stylesheet" href="/css/style.css?v=1.8.5"><script>window.lazyScripts=[]</script><meta name="generator" content="Hexo 4.2.1"></head><body><div id="loading" class="active"></div><aside id="menu" class="hide"><div class="inner flex-row-vertical"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off"><i class="icon icon-lg icon-close"></i></a><div class="brand-wrap" style="background-image:url(/img/brand.png)"><div class="brand"><a href="/" class="avatar waves-effect waves-circle waves-light"><img src="/img/ivitan.png"></a><hgroup class="introduce"><h5 class="nickname">VITAN</h5><a href="mailto:admin@vitan.me" title="admin@vitan.me" class="mail">admin@vitan.me</a></hgroup></div></div><div class="scroll-wrap flex-col"><ul class="nav"><li class="waves-block waves-effect"><a href="/"><i class="icon icon-lg icon-home"></i> Home</a></li><li class="waves-block waves-effect"><a href="/archives"><i class="icon icon-lg icon-archives"></i> Archive</a></li><li class="waves-block waves-effect"><a href="/tags"><i class="icon icon-lg icon-tags"></i> Tags</a></li><li class="waves-block waves-effect"><a href="/about"><i class="icon icon-lg icon-user"></i> About</a></li><li class="waves-block waves-effect"><a href="https://github.com/ivitan" target="_blank"><i class="icon icon-lg icon-github-alt"></i> Github</a></li></ul></div></div></aside><main id="main"><header class="top-header" id="header"><div class="flex-row"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle"><i class="icon icon-lg icon-navicon"></i></a><div class="flex-col header-title ellipsis">H3C 交换机常用命令</div><div class="search-wrap" id="search-wrap"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back"><i class="icon icon-lg icon-chevron-left"></i> </a><input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字"> <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search"><i class="icon icon-lg icon-search"></i></a></div></div></header><header class="content-header post-header"><div class="container fade-scale"><h1 class="title">H3C 交换机常用命令</h1><h5 class="subtitle"><time datetime="2020-05-15T07:27:38.000Z" itemprop="datePublished" class="page-time">2020-05-15</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coding/">Coding</a></li></ul></h5></div></header><div class="container body-wrap"><aside class="post-widget"><nav class="post-toc-wrap post-toc-shrink" id="post-toc"><h4>TOC</h4><ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#常用命令"><span class="post-toc-number">1.</span> <span class="post-toc-text">常用命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#用户配置"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">用户配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#系统IP配置"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">系统IP配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#DHCP客户端配置"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">DHCP客户端配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#端口配置"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">端口配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#VLAN-配置"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">VLAN 配置</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Work-常用"><span class="post-toc-number">2.</span> <span class="post-toc-text">Work 常用</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#命令"><span class="post-toc-number">3.</span> <span class="post-toc-text">命令</span></a></li></ol></nav></aside><article id="post-H3C" class="post-article article-type-post fade" itemprop="blogPost"><div class="post-card"><h1 class="post-card-title">H3C 交换机常用命令</h1><div class="post-meta"><time class="post-time" title="2020-05-15 15:27:38" datetime="2020-05-15T07:27:38.000Z" itemprop="datePublished"><i class="icon icon-calendar"></i> 2020-05-15</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Coding/">Coding</a></li></ul><span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none"><i class="icon icon-eye" style="padding:0 .3em"></i><span id="busuanzi_value_page_pv"></span></span></div><div class="post-content" id="post-content" itemprop="postContent"><p>H3C 交换机常用命令</p><a id="more"></a><h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><h2 id="用户配置"><a href="#用户配置" class="headerlink" title="用户配置"></a>用户配置</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;H3C&gt;system-view</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置用户分级密码</span></span><br><span class="line">[H3C]super password H3C </span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除用户分级密码</span></span><br><span class="line">[H3C]undo super password </span><br><span class="line"></span><br><span class="line"><span class="comment"># Web网管用户设置,1（缺省）为管理级用户,缺省admin,admin</span></span><br><span class="line">[H3C]localuser bigheap 123456 1 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除Web网管用户</span></span><br><span class="line">[H3C]undo localuser bigheap </span><br><span class="line"></span><br><span class="line"><span class="comment"># 只支持0</span></span><br><span class="line">[H3C]user-interface aux 0 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置超时为2分50秒,若为0则表示不超时,默认为5分钟</span></span><br><span class="line">[H3C-Aux]idle-timeout 2 50 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复默认值</span></span><br><span class="line">[H3C-Aux]undo idle-timeout </span><br><span class="line"></span><br><span class="line"><span class="comment"># 只支持0和1</span></span><br><span class="line">[H3C]user-interface vty 0 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置超时为2分50秒,若为0则表示不超时,默认为5分钟</span></span><br><span class="line">[H3C-vty]idle-timeout 2 50 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复默认值</span></span><br><span class="line">[H3C-vty]undo idle-timeout </span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置telnet密码,必须设置</span></span><br><span class="line">[H3C-vty]<span class="builtin-name">set</span> authentication password 123456 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 取消密码</span></span><br><span class="line">[H3C-vty]undo <span class="builtin-name">set</span> authentication password </span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示用户</span></span><br><span class="line">[H3C]display<span class="built_in"> users </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示用户界面状态</span></span><br><span class="line">[H3C]display user-interface</span><br></pre></td></tr></table></figure><h2 id="系统IP配置"><a href="#系统IP配置" class="headerlink" title="系统IP配置"></a>系统IP配置</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[H3C]vlan 20</span><br><span class="line">[H3C]management-vlan 20</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并进入管理VLAN</span></span><br><span class="line">[H3C]interface vlan-interface 20 </span><br><span class="line"></span><br><span class="line"><span class="comment">#  删除管理VLAN接口</span></span><br><span class="line">[H3C]undo<span class="built_in"> interface </span>vlan-interface 20</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置管理VLAN接口静态IP地址(缺省为192.168.0.234)</span></span><br><span class="line">[H3C-Vlan-interface20]ip<span class="built_in"> address </span>192.168.1.2 255.255.255.0 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除IP地址</span></span><br><span class="line">[H3C-Vlan-interface20]undo<span class="built_in"> ip </span>address</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定缺省网关(默认无网关地址)</span></span><br><span class="line">[H3C-Vlan-interface20]ip gateway 192.168.1.1 </span><br><span class="line">[H3C-Vlan-interface20]undo<span class="built_in"> ip </span>gateway</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭接口</span></span><br><span class="line">[H3C-Vlan-interface20]shutdown </span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启</span></span><br><span class="line">[H3C-Vlan-interface20]undo shutdown </span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示管理VLAN接口IP的相关信息</span></span><br><span class="line">[H3C]display<span class="built_in"> ip </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  查看管理VLAN的接口信息</span></span><br><span class="line">[H3C]display<span class="built_in"> interface </span>vlan-interface 20</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启IP调试功能</span></span><br><span class="line">&lt;H3C&gt;debugging<span class="built_in"> ip </span></span><br><span class="line">&lt;H3C&gt;undo debugging ip</span><br></pre></td></tr></table></figure><h2 id="DHCP客户端配置"><a href="#DHCP客户端配置" class="headerlink" title="DHCP客户端配置"></a>DHCP客户端配置</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 管理VLAN接口通过DHCP方式获取IP地址</span></span><br><span class="line">[H3C-Vlan-interface20]ip<span class="built_in"> address </span>dhcp-alloc </span><br><span class="line"></span><br><span class="line"><span class="comment"># 取消</span></span><br><span class="line">[H3C-Vlan-interface20]undo<span class="built_in"> ip address </span>dhcp-alloc </span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示DHCP客户信息</span></span><br><span class="line">[H3C]display dhcp </span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启DHCP调试功能</span></span><br><span class="line">&lt;H3C&gt;debugging dhcp-alloc </span><br><span class="line"></span><br><span class="line">&lt;H3C&gt;undo debugging dhcp-alloc</span><br></pre></td></tr></table></figure><h2 id="端口配置"><a href="#端口配置" class="headerlink" title="端口配置"></a>端口配置</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">[H3C]interface Ethernet0/3</span><br><span class="line">[H3C-Ethernet0/3]shutdown</span><br><span class="line"></span><br><span class="line"><span class="comment"># 速率,可为10,100,1000和auto(缺省)</span></span><br><span class="line">[H3C-Ethernet0/3]speed 100 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 双工,可为half,full和auto(缺省) 光口和汇聚后不能配置</span></span><br><span class="line">[H3C-Ethernet0/3]duplex full </span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启流控,默认为关闭</span></span><br><span class="line">[H3C-Ethernet0/3]flow-control </span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置抑制广播百分比为20%,可取5,10,20,100,缺省为100</span></span><br><span class="line"><span class="comment"># 同时组播和未知单播也受此影响</span></span><br><span class="line">[H3C-Ethernet0/3]broadcast-suppression 20 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 内环测试</span></span><br><span class="line">[H3C-Ethernet0/3]loopback internal </span><br><span class="line"></span><br><span class="line"><span class="comment"># 外环测试,需插接自环头,必须为全双工或者自协商模式</span></span><br><span class="line">[H3C-Ethernet0/3]loopback external </span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置链路的类型为trunk,可为access(缺省),trunk</span></span><br><span class="line">[H3C-Ethernet0/3]port link-type trunk </span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置20为该trunk的缺省VLAN,默认为1(trunk线路两端的PVID必须一致)</span></span><br><span class="line">[H3C-Ethernet0/3]port trunk pvid<span class="built_in"> vlan </span>20 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将当前access端口加入指定的VLAN</span></span><br><span class="line">[H3C-Ethernet0/3]port access<span class="built_in"> vlan </span>20 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 允许所有的VLAN通过当前的trunk端口,可多次使用该命令</span></span><br><span class="line">[H3C-Ethernet0/3]port trunk permit<span class="built_in"> vlan </span>all </span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置以太端口为自动监测,normal(缺省)为直通线,across为交叉线</span></span><br><span class="line">[H3C-Ethernet0/3]mdi auto </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将1-4口加入汇聚组,1为主端口,两端需要同时配置,</span></span><br><span class="line"><span class="comment"># 设置了端口镜像以及端口隔离的端口无法汇聚</span></span><br><span class="line">[H3C]link-aggregation<span class="built_in"> Ethernet </span>0/1 <span class="keyword">to</span><span class="built_in"> Ethernet </span>0/4 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除该汇聚组</span></span><br><span class="line">[H3C]undo link-aggregation<span class="built_in"> Ethernet </span>0/1 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置端口汇聚模式为根据目的MAC地址进行负荷分担,</span></span><br><span class="line"><span class="comment"># 可选为 ingress,egress和both,缺省为both</span></span><br><span class="line">[H3C]link-aggregation mode egress </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将该端口设置为镜像端口,必须先设置镜像端口,删除时必须先删除被镜像端口,</span></span><br><span class="line"><span class="comment"># 而且它们不能同在一个端口,该端口不能在汇聚组中,设置新镜像端口时,新取代旧,被镜像不变</span></span><br><span class="line"></span><br><span class="line">[H3C]monitor-port<span class="built_in"> Ethernet </span>0/2 </span><br><span class="line"><span class="comment"># 将端口3和4设置为被镜像端口,both为同时监控接收和发送的报文,</span></span><br><span class="line"><span class="comment"># inbound表示仅监控接收的报文,outbound表示仅监控发送的报文</span></span><br><span class="line"></span><br><span class="line">[H3C]mirroring-port<span class="built_in"> Ethernet </span>0/3 <span class="keyword">to</span><span class="built_in"> Ethernet </span>0/4 both </span><br><span class="line">[H3C]display mirror</span><br><span class="line">[H3C]display<span class="built_in"> interface Ethernet </span>0/3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清除所有端口的统计信息</span></span><br><span class="line">&lt;H3C&gt;reset counters </span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示端口汇聚信息</span></span><br><span class="line">[H3C]display link-aggregation<span class="built_in"> Ethernet </span>0/3 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 诊断该端口的电路状况</span></span><br><span class="line">[H3C-Ethernet0/3]virtual-cable-test</span><br></pre></td></tr></table></figure><h2 id="VLAN-配置"><a href="#VLAN-配置" class="headerlink" title="VLAN 配置"></a>VLAN 配置</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[H3C]vlan 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除除缺省VLAN外的所有VLAN,缺省VLAN不能被删除</span></span><br><span class="line">[H3C]undo<span class="built_in"> vlan </span>all </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将4到7号端口加入到VLAN2中,此命令只能用来加access端口,</span></span><br><span class="line"><span class="comment"># 不能用来增加trunk或者hybrid端口</span></span><br><span class="line">[H3C-vlan2]port<span class="built_in"> Ethernet </span>0/4 <span class="keyword">to</span><span class="built_in"> Ethernet </span>0/7 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开VLAN内端口隔离特性,不能二层转发,默认不启用该功能</span></span><br><span class="line">[H3C-vlan2]port-isolate <span class="builtin-name">enable</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置4为VLAN2的隔离上行端口,用于转发二层数据,只能配置一个上行端口,</span></span><br><span class="line"><span class="comment"># 若为trunk,则建议允许所有VLAN通过,隔离不能与汇聚同时配置</span></span><br><span class="line">[H3C-Ethernet0/4]port-isolate uplink-port<span class="built_in"> vlan </span>2 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有VLAN的详细信息</span></span><br><span class="line">[H3C]display<span class="built_in"> vlan </span>all </span><br><span class="line"></span><br><span class="line"><span class="comment"># S1550E支持基于端口的VLAN,通过创建不同的user-group来实现,</span></span><br><span class="line"><span class="comment"># 一个端口可以属于多个user-group,不属于同一个user-group的端口不能互相通信, </span></span><br><span class="line"><span class="comment"># 最多支持50个user-group</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建user-group 20,默认只存在user-group 1</span></span><br><span class="line">[H3C]user-group 20 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将4到7号端口加入到VLAN20中,初始时都属于user-group 1中</span></span><br><span class="line">[H3C-UserGroup20]port<span class="built_in"> Ethernet </span>0/4 <span class="keyword">to</span><span class="built_in"> Ethernet </span>0/7 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示user-group 20的相关信息</span></span><br><span class="line">[H3C]display user-group 20</span><br></pre></td></tr></table></figure><h1 id="Work-常用"><a href="#Work-常用" class="headerlink" title="Work 常用"></a>Work 常用</h1><ul><li>进入特权模式</li></ul><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sys</span></span><br></pre></td></tr></table></figure><ul><li>进入端口</li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> e0/<span class="number">0</span>/端口号 </span><br><span class="line"><span class="built_in">int</span> e1/<span class="number">0</span>/端口号</span><br></pre></td></tr></table></figure><ul><li>打开/关闭自动获取mac</li></ul><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mac-<span class="built_in">address</span> <span class="built_in">max</span>-mac-<span class="built_in">count</span> <span class="number">1</span></span><br><span class="line">mac-<span class="built_in">address</span> <span class="built_in">max</span>-mac-<span class="built_in">count</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><ul><li>查找 mac</li></ul><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dis</span> <span class="keyword">mac</span>-address | <span class="keyword">include</span> aebe</span><br></pre></td></tr></table></figure><ul><li>查看 Vlan 的 arp</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dis arp<span class="built_in"> vlan </span>216</span><br></pre></td></tr></table></figure><ul><li>查看端口目前 vlan</li></ul><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dis th</span></span><br></pre></td></tr></table></figure><ul><li>关闭/启用端口</li></ul><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">shutdown</span></span><br><span class="line">un <span class="built_in">shutdown</span></span><br></pre></td></tr></table></figure><ul><li>查看端口获取mac：</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dis mac-address<span class="built_in"> vlan </span>00</span><br></pre></td></tr></table></figure><ul><li>mac绑定端口：</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mac-address static 0000-0000-0000<span class="built_in"> vlan </span>00</span><br></pre></td></tr></table></figure><ul><li>退出：quit</li><li>保存：save</li><li>取消：undo</li></ul><h1 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h1><ul><li>查看Linux下查看端口状态</li></ul><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -an<span class="string">|grep -E "</span><span class="number">6002</span><span class="string">|6003"</span></span><br></pre></td></tr></table></figure><ul><li>显示当前配置</li></ul><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">display <span class="keyword">current</span>-<span class="keyword">configuration</span></span><br></pre></td></tr></table></figure><ul><li>显示arp信息</li></ul><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dis arp</span></span><br></pre></td></tr></table></figure><ul><li>显示mac列表信息</li></ul><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dis</span> <span class="keyword">mac</span>-address</span><br></pre></td></tr></table></figure><ul><li>显示端口信息</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">display <span class="class"><span class="keyword">interface</span></span></span><br></pre></td></tr></table></figure><ul><li>进入系统视图</li></ul><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">system</span>-<span class="built_in">view</span></span><br></pre></td></tr></table></figure><ul><li>打开路由器的telnet功能</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C]telnet<span class="built_in"> server </span>enable</span><br></pre></td></tr></table></figure><ul><li>设置允许同时配置路由器的用户数</li></ul><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C]configure-<span class="keyword">user</span> <span class="title">count</span> <span class="number">5</span></span><br></pre></td></tr></table></figure><ul><li>添加本地用户(此处为telnet用户登录时使用的用户名)</li></ul><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C]local-<span class="keyword">user</span> <span class="title">telnet</span></span><br></pre></td></tr></table></figure><ul><li>设置telnet用户登录时所使用的密码</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C-luser-telnet]password<span class="built_in"> simple </span>h3c</span><br></pre></td></tr></table></figure><ul><li>设置本地用户的服务类型(此处为telnet)</li></ul><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">H3C</span>-luser-telnet]service-<span class="keyword">type</span> telnet</span><br></pre></td></tr></table></figure><ul><li>设置本地用户的服务级别</li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C-luser-telnet]level <span class="number">3</span></span><br></pre></td></tr></table></figure><ul><li>退出本地用户视图</li></ul><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C-luser-telnet]<span class="keyword">quit</span></span><br></pre></td></tr></table></figure><ul><li>进入用户视图</li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C]user-<span class="keyword">interface</span> <span class="symbol">vty</span> <span class="symbol">0</span> <span class="symbol">4</span></span><br></pre></td></tr></table></figure><ul><li>选择“scheme”认证方式</li></ul><figure class="highlight mizar"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C-ui-vty0-4]authentication-<span class="keyword">mode</span> <span class="keyword">scheme</span></span><br></pre></td></tr></table></figure><ul><li>进入某个端口</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C]<span class="built_in"> interface </span>serial 3/0</span><br></pre></td></tr></table></figure><ul><li>为该端口设置ip</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C-Serial3/0]ip<span class="built_in"> address </span>200.1.1.1 255.255.255.0</span><br></pre></td></tr></table></figure><ul><li>对该端口进行复位</li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C-Serial3/<span class="number">0</span>]undo shutdown</span><br></pre></td></tr></table></figure><ul><li>添加一条静态路由</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[H3C]</span><span class="selector-tag">ip</span> <span class="selector-tag">route-static</span> 192<span class="selector-class">.168</span><span class="selector-class">.1</span><span class="selector-class">.0</span> 255<span class="selector-class">.255</span><span class="selector-class">.255</span><span class="selector-class">.0</span> 192<span class="selector-class">.168</span><span class="selector-class">.0</span><span class="selector-class">.1</span></span><br></pre></td></tr></table></figure><ul><li>添加一条默认路由</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[H3C]</span><span class="selector-tag">ip</span> <span class="selector-tag">route-static</span> 0<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.0</span>  0<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.0</span>  192<span class="selector-class">.168</span><span class="selector-class">.0</span><span class="selector-class">.1</span></span><br></pre></td></tr></table></figure><ul><li>保存配置文件</li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">H3C</span>]save</span><br></pre></td></tr></table></figure><ul><li>查看某端口的状态</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C]display<span class="built_in"> interface </span>GigabitEthernet 0/0</span><br></pre></td></tr></table></figure><ul><li>创建vlan</li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C]vlan <span class="number">10</span></span><br></pre></td></tr></table></figure><ul><li>将某个端口加入到vlan中</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C-vlan100]port<span class="built_in"> ethernet </span>0/1</span><br></pre></td></tr></table></figure><ul><li>创建vlan虚拟口</li></ul><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C]<span class="keyword">interface</span> vlan-<span class="keyword">interface</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><ul><li>配置ip地址</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C-Vlan-interface100]ip<span class="built_in"> address </span>192.168.1.4  255.255.255.0</span><br></pre></td></tr></table></figure><ul><li>将端口类型设置为trunk</li></ul><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C]port  link-<span class="class"><span class="keyword">type</span> <span class="title">trunk</span></span></span><br></pre></td></tr></table></figure><ul><li>设置trunk口允许所有vlan通过(需要执行save保存)</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C]port  trunk permit<span class="built_in"> vlan </span>all</span><br></pre></td></tr></table></figure><p>注意：Trunk 可以收发多个vlan的报文，用于交换机与交换机之间的互连</p><ul><li>关闭端口</li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C-GigabitEthernet1/<span class="number">1</span>/<span class="number">1</span>]shutdown</span><br></pre></td></tr></table></figure><ul><li>设置端口备注</li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[H3C-Ethernet1/<span class="number">0</span>/<span class="number">15</span>]description 测试数据</span><br></pre></td></tr></table></figure></div><blockquote class="post-copyright"><div class="content"><span class="post-time">最后更新时间：<time datetime="2020-09-13T03:21:39.873Z" itemprop="dateUpdated">2020-09-13 11:21:39</time></span><br>原始链接：<a href="/posts/H3C.html" target="_blank" rel="external">https://vitan.me/posts/H3C.html</a></div><footer><a href="https://vitan.me"><img src="/img/ivitan.png" alt="VITAN"> VITAN</a></footer></blockquote><div class="page-reward"><a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a></div><div class="post-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Network/" rel="tag">Network</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Switch/" rel="tag">Switch</a></li></ul></div></div><nav class="post-nav flex-row flex-justify-between"><div class="waves-block waves-effect prev"><a href="/posts/NetWork.html" id="post-prev" class="post-nav-link"><div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div><h4 class="title">NetWork Learn</h4></a></div><div class="waves-block waves-effect next"><a href="/posts/PicGo.html" id="post-next" class="post-nav-link"><div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div><h4 class="title">PicGo 使用 JsDeliver CDN 加速</h4></a></div></nav><div class="comments vcomment" id="comments"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(e){return-1<GUEST_INFO.indexOf(e)});new Valine({el:"#comments",notify:!1,verify:!1,appId:"D33WPBHpBw2CjwdWpFvpUhDm-MdYXbMMI",appKey:"MzQtKvSeVPU4nS4ljd3zlbMp",avatar:"wavatar",placeholder:"Write a comment here.",guest_info:0==guest_info.length?GUEST_INFO:guest_info,pageSize:"10"})</script></article><div id="reward" class="page-modal reward-lay"><a class="close" href="javascript:;"><i class="icon icon-close"></i></a><h3 class="reward-title"><i class="icon icon-quote-left"></i> 感谢支持 <i class="icon icon-quote-right"></i></h3><div class="reward-content"><div class="reward-code"><img id="rewardCode" src="/img/wechat.png" alt="打赏二维码"></div><label class="reward-toggle"><input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/wechat.png" data-alipay="/img/alipay.png"><div class="reward-toggle-ctrol"><span class="reward-toggle-item wechat">微信</span> <span class="reward-toggle-item switch" id="switvh">切换</span> <span class="reward-toggle-item alipay">支付宝</span></div></label></div></div><script src="//unpkg.com/jquery@latest/dist/jquery.min.js"></script><script src="/js/clipboard.min.js?v=1.8.5"></script><script src="/js/copy.min.js?v=1.8.5"></script></div><footer class="footer"><div class="top"><p><span id="busuanzi_container_site_uv" style="display:none"><i class="icon icon-user"></i><span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" style="display:none"><i class="icon icon-eye"></i><span id="busuanzi_value_site_pv"></span></span></p><p><span>VITAN &copy; 2017 - 2020</span> <span>Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/ivitan/indigo" target="_blank">Indigo</a></span></p></div><div class="bottom"><p><span><a href="/xml/atom.xml" target="_blank" class="rss" title="RSS"><i class="icon icon-lg icon-rss"></i></a></span> <span>内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 协议</a></span></p></div></footer></main><div class="mask" id="mask"></div><a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a><script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script><script>var BLOG={ROOT:"/",SHARE:!1,REWARD:!0}</script><script src="/js/main.min.js?v=1.8.5"></script><div class="search-panel" id="search-panel"><ul class="search-result" id="search-result"></ul></div><template id="search-tpl"><li class="item"><a href="{path}" class="waves-block waves-effect"><div class="title ellipsis" title="{title}">{title}</div><div class="flex-row flex-middle"><div class="tags ellipsis">{tags}</div><time class="flex-col time">{date}</time></div></a></li></template><script src="/js/search.min.js?v=1.8.5" async></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>